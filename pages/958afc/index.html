<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>线程状态、优先级、停止、休眠、礼让、守护和同步机制 | x·π</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/xpai/img/favicon.ico">
    <script data-ad-client="ca-pub-7828333725993554" async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <meta name="description" content="x·π学院，为开发者量身制作的技术博客和知识库管理平台,简洁至上,专注于前后端技术学习与总结。">
    <meta name="keywords" content="xpai,x,pai,java,前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/xpai/assets/css/0.styles.79838e76.css" as="style"><link rel="preload" href="/xpai/assets/js/app.463a16ef.js" as="script"><link rel="preload" href="/xpai/assets/js/2.86da3580.js" as="script"><link rel="preload" href="/xpai/assets/js/34.a5238ebc.js" as="script"><link rel="prefetch" href="/xpai/assets/js/10.7ee6e0f7.js"><link rel="prefetch" href="/xpai/assets/js/100.ca97340e.js"><link rel="prefetch" href="/xpai/assets/js/101.9fe98dac.js"><link rel="prefetch" href="/xpai/assets/js/102.c21bb621.js"><link rel="prefetch" href="/xpai/assets/js/103.8a98d2bf.js"><link rel="prefetch" href="/xpai/assets/js/104.32ba745b.js"><link rel="prefetch" href="/xpai/assets/js/105.e97d1142.js"><link rel="prefetch" href="/xpai/assets/js/106.0eee2433.js"><link rel="prefetch" href="/xpai/assets/js/107.f18ecd30.js"><link rel="prefetch" href="/xpai/assets/js/108.ed1584c8.js"><link rel="prefetch" href="/xpai/assets/js/109.e3f69cfb.js"><link rel="prefetch" href="/xpai/assets/js/11.d966c9a1.js"><link rel="prefetch" href="/xpai/assets/js/110.c1ae9e32.js"><link rel="prefetch" href="/xpai/assets/js/111.a543b13d.js"><link rel="prefetch" href="/xpai/assets/js/112.559c21bb.js"><link rel="prefetch" href="/xpai/assets/js/113.fc113adc.js"><link rel="prefetch" href="/xpai/assets/js/114.50d5e5a7.js"><link rel="prefetch" href="/xpai/assets/js/115.d86f7ff2.js"><link rel="prefetch" href="/xpai/assets/js/116.0b3801f6.js"><link rel="prefetch" href="/xpai/assets/js/117.a56de7c9.js"><link rel="prefetch" href="/xpai/assets/js/118.1eaab9b4.js"><link rel="prefetch" href="/xpai/assets/js/119.d692ea2a.js"><link rel="prefetch" href="/xpai/assets/js/12.8fe99824.js"><link rel="prefetch" href="/xpai/assets/js/120.1bb73ce4.js"><link rel="prefetch" href="/xpai/assets/js/121.ad4fac1b.js"><link rel="prefetch" href="/xpai/assets/js/122.71447b1b.js"><link rel="prefetch" href="/xpai/assets/js/123.24d55eec.js"><link rel="prefetch" href="/xpai/assets/js/124.30b0b26e.js"><link rel="prefetch" href="/xpai/assets/js/125.3c3c7cbd.js"><link rel="prefetch" href="/xpai/assets/js/126.4b8fcd6e.js"><link rel="prefetch" href="/xpai/assets/js/127.9aed11fd.js"><link rel="prefetch" href="/xpai/assets/js/128.ccbfe4a0.js"><link rel="prefetch" href="/xpai/assets/js/129.fe318607.js"><link rel="prefetch" href="/xpai/assets/js/13.b8cb0a32.js"><link rel="prefetch" href="/xpai/assets/js/130.d27b4321.js"><link rel="prefetch" href="/xpai/assets/js/131.54d5c00c.js"><link rel="prefetch" href="/xpai/assets/js/132.d8986010.js"><link rel="prefetch" href="/xpai/assets/js/133.f861411c.js"><link rel="prefetch" href="/xpai/assets/js/134.286bfa2b.js"><link rel="prefetch" href="/xpai/assets/js/135.c3db6ed4.js"><link rel="prefetch" href="/xpai/assets/js/136.a5d2ce64.js"><link rel="prefetch" href="/xpai/assets/js/137.550a2277.js"><link rel="prefetch" href="/xpai/assets/js/138.8a99894a.js"><link rel="prefetch" href="/xpai/assets/js/139.ddbbc94f.js"><link rel="prefetch" href="/xpai/assets/js/14.dcefa034.js"><link rel="prefetch" href="/xpai/assets/js/140.3049d182.js"><link rel="prefetch" href="/xpai/assets/js/141.664f5c5d.js"><link rel="prefetch" href="/xpai/assets/js/142.7cee8107.js"><link rel="prefetch" href="/xpai/assets/js/143.f5ec918e.js"><link rel="prefetch" href="/xpai/assets/js/144.22fd0a33.js"><link rel="prefetch" href="/xpai/assets/js/145.c2333593.js"><link rel="prefetch" href="/xpai/assets/js/146.6d807a23.js"><link rel="prefetch" href="/xpai/assets/js/147.29a3cf6f.js"><link rel="prefetch" href="/xpai/assets/js/148.bd6ee5eb.js"><link rel="prefetch" href="/xpai/assets/js/149.7dc1d1ae.js"><link rel="prefetch" href="/xpai/assets/js/15.2a4d0706.js"><link rel="prefetch" href="/xpai/assets/js/150.f40432ae.js"><link rel="prefetch" href="/xpai/assets/js/151.a919b3cc.js"><link rel="prefetch" href="/xpai/assets/js/152.4fa71eca.js"><link rel="prefetch" href="/xpai/assets/js/153.817a4e74.js"><link rel="prefetch" href="/xpai/assets/js/154.2813e444.js"><link rel="prefetch" href="/xpai/assets/js/155.15e81052.js"><link rel="prefetch" href="/xpai/assets/js/156.fa34a481.js"><link rel="prefetch" href="/xpai/assets/js/157.b08b85b0.js"><link rel="prefetch" href="/xpai/assets/js/158.d5371c5a.js"><link rel="prefetch" href="/xpai/assets/js/159.dd75b5f2.js"><link rel="prefetch" href="/xpai/assets/js/16.100620ac.js"><link rel="prefetch" href="/xpai/assets/js/160.127a3238.js"><link rel="prefetch" href="/xpai/assets/js/161.bb763729.js"><link rel="prefetch" href="/xpai/assets/js/162.3f583d73.js"><link rel="prefetch" href="/xpai/assets/js/163.45f9c3c5.js"><link rel="prefetch" href="/xpai/assets/js/164.b517304e.js"><link rel="prefetch" href="/xpai/assets/js/165.78f3e227.js"><link rel="prefetch" href="/xpai/assets/js/166.52ab083a.js"><link rel="prefetch" href="/xpai/assets/js/167.3ff08448.js"><link rel="prefetch" href="/xpai/assets/js/168.b76ede0e.js"><link rel="prefetch" href="/xpai/assets/js/169.e7045a07.js"><link rel="prefetch" href="/xpai/assets/js/17.edd38bb7.js"><link rel="prefetch" href="/xpai/assets/js/170.28967c99.js"><link rel="prefetch" href="/xpai/assets/js/171.c3b3d33f.js"><link rel="prefetch" href="/xpai/assets/js/172.8efd4d5f.js"><link rel="prefetch" href="/xpai/assets/js/173.e8929a24.js"><link rel="prefetch" href="/xpai/assets/js/174.69fd1c95.js"><link rel="prefetch" href="/xpai/assets/js/175.71b34cd8.js"><link rel="prefetch" href="/xpai/assets/js/176.d12259c4.js"><link rel="prefetch" href="/xpai/assets/js/177.43021615.js"><link rel="prefetch" href="/xpai/assets/js/178.2110b762.js"><link rel="prefetch" href="/xpai/assets/js/179.3ee7894a.js"><link rel="prefetch" href="/xpai/assets/js/18.60ad374d.js"><link rel="prefetch" href="/xpai/assets/js/180.0203c68e.js"><link rel="prefetch" href="/xpai/assets/js/181.9de24c6a.js"><link rel="prefetch" href="/xpai/assets/js/182.8bd7b605.js"><link rel="prefetch" href="/xpai/assets/js/183.7b9777ab.js"><link rel="prefetch" href="/xpai/assets/js/184.06c8f682.js"><link rel="prefetch" href="/xpai/assets/js/185.533fd089.js"><link rel="prefetch" href="/xpai/assets/js/186.da02af0d.js"><link rel="prefetch" href="/xpai/assets/js/187.0ad9bbf4.js"><link rel="prefetch" href="/xpai/assets/js/188.680a1397.js"><link rel="prefetch" href="/xpai/assets/js/189.2b70c6ba.js"><link rel="prefetch" href="/xpai/assets/js/19.37ca1303.js"><link rel="prefetch" href="/xpai/assets/js/190.72b2201b.js"><link rel="prefetch" href="/xpai/assets/js/191.452f27d6.js"><link rel="prefetch" href="/xpai/assets/js/192.77a42070.js"><link rel="prefetch" href="/xpai/assets/js/193.5df63776.js"><link rel="prefetch" href="/xpai/assets/js/194.60512671.js"><link rel="prefetch" href="/xpai/assets/js/195.dfee0b35.js"><link rel="prefetch" href="/xpai/assets/js/196.b089bf1c.js"><link rel="prefetch" href="/xpai/assets/js/197.3231ab2f.js"><link rel="prefetch" href="/xpai/assets/js/198.d7cc85e4.js"><link rel="prefetch" href="/xpai/assets/js/199.49b9190b.js"><link rel="prefetch" href="/xpai/assets/js/20.49b1af17.js"><link rel="prefetch" href="/xpai/assets/js/200.312f11fb.js"><link rel="prefetch" href="/xpai/assets/js/201.22e1bc76.js"><link rel="prefetch" href="/xpai/assets/js/202.df0ea0e5.js"><link rel="prefetch" href="/xpai/assets/js/203.8e21b7a0.js"><link rel="prefetch" href="/xpai/assets/js/204.2ae4a97a.js"><link rel="prefetch" href="/xpai/assets/js/205.5cbe7da4.js"><link rel="prefetch" href="/xpai/assets/js/206.d5e490e9.js"><link rel="prefetch" href="/xpai/assets/js/207.f34c5ce1.js"><link rel="prefetch" href="/xpai/assets/js/208.5fdf7bf3.js"><link rel="prefetch" href="/xpai/assets/js/209.b028c8d0.js"><link rel="prefetch" href="/xpai/assets/js/21.db66bdd8.js"><link rel="prefetch" href="/xpai/assets/js/210.75dfc456.js"><link rel="prefetch" href="/xpai/assets/js/211.76bdfd3a.js"><link rel="prefetch" href="/xpai/assets/js/212.6f693c8e.js"><link rel="prefetch" href="/xpai/assets/js/213.78008b66.js"><link rel="prefetch" href="/xpai/assets/js/214.0289290f.js"><link rel="prefetch" href="/xpai/assets/js/215.fea6ffaf.js"><link rel="prefetch" href="/xpai/assets/js/216.232c62bc.js"><link rel="prefetch" href="/xpai/assets/js/217.7eb2090b.js"><link rel="prefetch" href="/xpai/assets/js/218.40542780.js"><link rel="prefetch" href="/xpai/assets/js/219.0a908ea4.js"><link rel="prefetch" href="/xpai/assets/js/22.ad9dc733.js"><link rel="prefetch" href="/xpai/assets/js/220.b0417a42.js"><link rel="prefetch" href="/xpai/assets/js/221.24ec4a64.js"><link rel="prefetch" href="/xpai/assets/js/222.5cd49c8f.js"><link rel="prefetch" href="/xpai/assets/js/223.c502ecd6.js"><link rel="prefetch" href="/xpai/assets/js/224.1de749c7.js"><link rel="prefetch" href="/xpai/assets/js/225.f3d0e310.js"><link rel="prefetch" href="/xpai/assets/js/226.65550f73.js"><link rel="prefetch" href="/xpai/assets/js/227.dda125e0.js"><link rel="prefetch" href="/xpai/assets/js/228.5a206fc6.js"><link rel="prefetch" href="/xpai/assets/js/229.d4421e9e.js"><link rel="prefetch" href="/xpai/assets/js/23.3428586b.js"><link rel="prefetch" href="/xpai/assets/js/230.c74da9c1.js"><link rel="prefetch" href="/xpai/assets/js/231.9a0a1cf7.js"><link rel="prefetch" href="/xpai/assets/js/232.e63a0e1f.js"><link rel="prefetch" href="/xpai/assets/js/233.df08bcaa.js"><link rel="prefetch" href="/xpai/assets/js/234.96ed772e.js"><link rel="prefetch" href="/xpai/assets/js/235.3ec201f2.js"><link rel="prefetch" href="/xpai/assets/js/236.57013513.js"><link rel="prefetch" href="/xpai/assets/js/237.914aea19.js"><link rel="prefetch" href="/xpai/assets/js/238.a202c8a7.js"><link rel="prefetch" href="/xpai/assets/js/239.9f593f79.js"><link rel="prefetch" href="/xpai/assets/js/24.1ec99cff.js"><link rel="prefetch" href="/xpai/assets/js/240.8e44d3ca.js"><link rel="prefetch" href="/xpai/assets/js/241.4ba1e308.js"><link rel="prefetch" href="/xpai/assets/js/242.8529cc75.js"><link rel="prefetch" href="/xpai/assets/js/243.5004c9b3.js"><link rel="prefetch" href="/xpai/assets/js/244.a2119850.js"><link rel="prefetch" href="/xpai/assets/js/245.8c643ead.js"><link rel="prefetch" href="/xpai/assets/js/246.c0fba80d.js"><link rel="prefetch" href="/xpai/assets/js/247.000e839a.js"><link rel="prefetch" href="/xpai/assets/js/248.2d135521.js"><link rel="prefetch" href="/xpai/assets/js/249.3422287d.js"><link rel="prefetch" href="/xpai/assets/js/25.117dc1ab.js"><link rel="prefetch" href="/xpai/assets/js/250.f329da47.js"><link rel="prefetch" href="/xpai/assets/js/251.51e2aad1.js"><link rel="prefetch" href="/xpai/assets/js/252.9cb3d88b.js"><link rel="prefetch" href="/xpai/assets/js/253.9da51af7.js"><link rel="prefetch" href="/xpai/assets/js/254.3165fc09.js"><link rel="prefetch" href="/xpai/assets/js/255.cb4062a4.js"><link rel="prefetch" href="/xpai/assets/js/256.d79d6f90.js"><link rel="prefetch" href="/xpai/assets/js/257.12fb4db7.js"><link rel="prefetch" href="/xpai/assets/js/258.e1515c48.js"><link rel="prefetch" href="/xpai/assets/js/259.0a09c73f.js"><link rel="prefetch" href="/xpai/assets/js/26.7b6f1292.js"><link rel="prefetch" href="/xpai/assets/js/260.54480a98.js"><link rel="prefetch" href="/xpai/assets/js/261.0545fd8e.js"><link rel="prefetch" href="/xpai/assets/js/262.ff374c70.js"><link rel="prefetch" href="/xpai/assets/js/263.ee5f0590.js"><link rel="prefetch" href="/xpai/assets/js/264.483d0ef8.js"><link rel="prefetch" href="/xpai/assets/js/265.4da521dc.js"><link rel="prefetch" href="/xpai/assets/js/266.aaeb58f1.js"><link rel="prefetch" href="/xpai/assets/js/267.aca23f83.js"><link rel="prefetch" href="/xpai/assets/js/268.f3b2d4a1.js"><link rel="prefetch" href="/xpai/assets/js/269.b4409f77.js"><link rel="prefetch" href="/xpai/assets/js/27.4abb37d7.js"><link rel="prefetch" href="/xpai/assets/js/270.d76a14f2.js"><link rel="prefetch" href="/xpai/assets/js/271.8242cd05.js"><link rel="prefetch" href="/xpai/assets/js/272.799398e1.js"><link rel="prefetch" href="/xpai/assets/js/273.90aee646.js"><link rel="prefetch" href="/xpai/assets/js/274.f8b4ca70.js"><link rel="prefetch" href="/xpai/assets/js/275.c2ee0bd0.js"><link rel="prefetch" href="/xpai/assets/js/276.742fe95c.js"><link rel="prefetch" href="/xpai/assets/js/277.d6040ffc.js"><link rel="prefetch" href="/xpai/assets/js/278.ab5d4432.js"><link rel="prefetch" href="/xpai/assets/js/279.188e5df9.js"><link rel="prefetch" href="/xpai/assets/js/28.1c1fe9b2.js"><link rel="prefetch" href="/xpai/assets/js/280.e9b9f629.js"><link rel="prefetch" href="/xpai/assets/js/281.a83c892f.js"><link rel="prefetch" href="/xpai/assets/js/282.2fab9b7f.js"><link rel="prefetch" href="/xpai/assets/js/283.1971678f.js"><link rel="prefetch" href="/xpai/assets/js/284.9e42daa0.js"><link rel="prefetch" href="/xpai/assets/js/285.cd747472.js"><link rel="prefetch" href="/xpai/assets/js/286.8e468c09.js"><link rel="prefetch" href="/xpai/assets/js/287.22c9485f.js"><link rel="prefetch" href="/xpai/assets/js/288.34101bfd.js"><link rel="prefetch" href="/xpai/assets/js/289.d12821df.js"><link rel="prefetch" href="/xpai/assets/js/29.ab9e2995.js"><link rel="prefetch" href="/xpai/assets/js/290.73ca9fde.js"><link rel="prefetch" href="/xpai/assets/js/291.0e9a3b5a.js"><link rel="prefetch" href="/xpai/assets/js/292.ddd9db4e.js"><link rel="prefetch" href="/xpai/assets/js/293.5151011b.js"><link rel="prefetch" href="/xpai/assets/js/294.787e0f5a.js"><link rel="prefetch" href="/xpai/assets/js/295.6be83c2e.js"><link rel="prefetch" href="/xpai/assets/js/296.179e3bae.js"><link rel="prefetch" href="/xpai/assets/js/297.980f652e.js"><link rel="prefetch" href="/xpai/assets/js/298.827ba7c3.js"><link rel="prefetch" href="/xpai/assets/js/299.c7715539.js"><link rel="prefetch" href="/xpai/assets/js/3.cab0040e.js"><link rel="prefetch" href="/xpai/assets/js/30.bb98e080.js"><link rel="prefetch" href="/xpai/assets/js/300.3a5e31e3.js"><link rel="prefetch" href="/xpai/assets/js/301.652d80ac.js"><link rel="prefetch" href="/xpai/assets/js/302.388b4851.js"><link rel="prefetch" href="/xpai/assets/js/303.5f95420a.js"><link rel="prefetch" href="/xpai/assets/js/304.9543ba37.js"><link rel="prefetch" href="/xpai/assets/js/305.0a4d2b3d.js"><link rel="prefetch" href="/xpai/assets/js/306.16988031.js"><link rel="prefetch" href="/xpai/assets/js/307.4d7a759d.js"><link rel="prefetch" href="/xpai/assets/js/308.27e25b6a.js"><link rel="prefetch" href="/xpai/assets/js/309.8471a949.js"><link rel="prefetch" href="/xpai/assets/js/31.68e0e25d.js"><link rel="prefetch" href="/xpai/assets/js/310.e9b36953.js"><link rel="prefetch" href="/xpai/assets/js/311.5463ec0c.js"><link rel="prefetch" href="/xpai/assets/js/312.334ad312.js"><link rel="prefetch" href="/xpai/assets/js/313.7ce59ee7.js"><link rel="prefetch" href="/xpai/assets/js/314.24652da0.js"><link rel="prefetch" href="/xpai/assets/js/315.2cfa659a.js"><link rel="prefetch" href="/xpai/assets/js/316.6e19c913.js"><link rel="prefetch" href="/xpai/assets/js/317.4f08fa8e.js"><link rel="prefetch" href="/xpai/assets/js/318.c184fba2.js"><link rel="prefetch" href="/xpai/assets/js/319.d94e39eb.js"><link rel="prefetch" href="/xpai/assets/js/32.ef68da65.js"><link rel="prefetch" href="/xpai/assets/js/320.49cf32bc.js"><link rel="prefetch" href="/xpai/assets/js/321.c285126f.js"><link rel="prefetch" href="/xpai/assets/js/322.588c7bd1.js"><link rel="prefetch" href="/xpai/assets/js/323.9116b884.js"><link rel="prefetch" href="/xpai/assets/js/324.2ea5c8c8.js"><link rel="prefetch" href="/xpai/assets/js/325.5010ca7b.js"><link rel="prefetch" href="/xpai/assets/js/326.eb06b2a3.js"><link rel="prefetch" href="/xpai/assets/js/327.adc38e90.js"><link rel="prefetch" href="/xpai/assets/js/328.db03c4e6.js"><link rel="prefetch" href="/xpai/assets/js/329.acb93377.js"><link rel="prefetch" href="/xpai/assets/js/33.5d570484.js"><link rel="prefetch" href="/xpai/assets/js/330.646a6c29.js"><link rel="prefetch" href="/xpai/assets/js/331.b8782f0b.js"><link rel="prefetch" href="/xpai/assets/js/332.f0db34b4.js"><link rel="prefetch" href="/xpai/assets/js/333.fa51fd3e.js"><link rel="prefetch" href="/xpai/assets/js/334.60fc8f8d.js"><link rel="prefetch" href="/xpai/assets/js/335.e7cedbc9.js"><link rel="prefetch" href="/xpai/assets/js/336.23ebc07f.js"><link rel="prefetch" href="/xpai/assets/js/337.359d68de.js"><link rel="prefetch" href="/xpai/assets/js/338.5b6b6766.js"><link rel="prefetch" href="/xpai/assets/js/339.fc66f3d7.js"><link rel="prefetch" href="/xpai/assets/js/340.7cfc7432.js"><link rel="prefetch" href="/xpai/assets/js/341.4304cbba.js"><link rel="prefetch" href="/xpai/assets/js/342.ffa46baf.js"><link rel="prefetch" href="/xpai/assets/js/343.ce0a15f1.js"><link rel="prefetch" href="/xpai/assets/js/344.3324ad6c.js"><link rel="prefetch" href="/xpai/assets/js/345.141f5109.js"><link rel="prefetch" href="/xpai/assets/js/346.607ca4f2.js"><link rel="prefetch" href="/xpai/assets/js/347.7caeef96.js"><link rel="prefetch" href="/xpai/assets/js/348.f0775e41.js"><link rel="prefetch" href="/xpai/assets/js/349.a001db3d.js"><link rel="prefetch" href="/xpai/assets/js/35.59de4997.js"><link rel="prefetch" href="/xpai/assets/js/350.77cc6653.js"><link rel="prefetch" href="/xpai/assets/js/351.34fe0651.js"><link rel="prefetch" href="/xpai/assets/js/36.ff92d3c8.js"><link rel="prefetch" href="/xpai/assets/js/37.4351ce5f.js"><link rel="prefetch" href="/xpai/assets/js/38.9eca4ff4.js"><link rel="prefetch" href="/xpai/assets/js/39.265a5d9a.js"><link rel="prefetch" href="/xpai/assets/js/4.10fa6d3b.js"><link rel="prefetch" href="/xpai/assets/js/40.3635d39d.js"><link rel="prefetch" href="/xpai/assets/js/41.4f91b146.js"><link rel="prefetch" href="/xpai/assets/js/42.2b713cb9.js"><link rel="prefetch" href="/xpai/assets/js/43.2c34c804.js"><link rel="prefetch" href="/xpai/assets/js/44.8f191f8f.js"><link rel="prefetch" href="/xpai/assets/js/45.4f628df8.js"><link rel="prefetch" href="/xpai/assets/js/46.1c757b3d.js"><link rel="prefetch" href="/xpai/assets/js/47.2961b598.js"><link rel="prefetch" href="/xpai/assets/js/48.54ffe40c.js"><link rel="prefetch" href="/xpai/assets/js/49.e0e4765d.js"><link rel="prefetch" href="/xpai/assets/js/5.ab0b3475.js"><link rel="prefetch" href="/xpai/assets/js/50.2de67866.js"><link rel="prefetch" href="/xpai/assets/js/51.e1ce0592.js"><link rel="prefetch" href="/xpai/assets/js/52.21f1bb15.js"><link rel="prefetch" href="/xpai/assets/js/53.557503f1.js"><link rel="prefetch" href="/xpai/assets/js/54.98566dfe.js"><link rel="prefetch" href="/xpai/assets/js/55.960d350f.js"><link rel="prefetch" href="/xpai/assets/js/56.e59740f6.js"><link rel="prefetch" href="/xpai/assets/js/57.f5af4efc.js"><link rel="prefetch" href="/xpai/assets/js/58.3db80afc.js"><link rel="prefetch" href="/xpai/assets/js/59.fb2fac89.js"><link rel="prefetch" href="/xpai/assets/js/6.41101de3.js"><link rel="prefetch" href="/xpai/assets/js/60.ef88b46d.js"><link rel="prefetch" href="/xpai/assets/js/61.331d64e6.js"><link rel="prefetch" href="/xpai/assets/js/62.c5cbce0e.js"><link rel="prefetch" href="/xpai/assets/js/63.6dbec697.js"><link rel="prefetch" href="/xpai/assets/js/64.46384523.js"><link rel="prefetch" href="/xpai/assets/js/65.5ff2ae14.js"><link rel="prefetch" href="/xpai/assets/js/66.97f80a65.js"><link rel="prefetch" href="/xpai/assets/js/67.bf1f054e.js"><link rel="prefetch" href="/xpai/assets/js/68.8e84d8ae.js"><link rel="prefetch" href="/xpai/assets/js/69.a3026fe1.js"><link rel="prefetch" href="/xpai/assets/js/7.7b35634d.js"><link rel="prefetch" href="/xpai/assets/js/70.40196887.js"><link rel="prefetch" href="/xpai/assets/js/71.0058aceb.js"><link rel="prefetch" href="/xpai/assets/js/72.7b3cc131.js"><link rel="prefetch" href="/xpai/assets/js/73.cd93e827.js"><link rel="prefetch" href="/xpai/assets/js/74.1600d2c6.js"><link rel="prefetch" href="/xpai/assets/js/75.4662b401.js"><link rel="prefetch" href="/xpai/assets/js/76.0163c641.js"><link rel="prefetch" href="/xpai/assets/js/77.d30ad138.js"><link rel="prefetch" href="/xpai/assets/js/78.70e29d3d.js"><link rel="prefetch" href="/xpai/assets/js/79.d7dd87f6.js"><link rel="prefetch" href="/xpai/assets/js/8.5f0e5018.js"><link rel="prefetch" href="/xpai/assets/js/80.e15cdd35.js"><link rel="prefetch" href="/xpai/assets/js/81.d7722150.js"><link rel="prefetch" href="/xpai/assets/js/82.8db1dc2d.js"><link rel="prefetch" href="/xpai/assets/js/83.8cdd8e3d.js"><link rel="prefetch" href="/xpai/assets/js/84.be3bbb89.js"><link rel="prefetch" href="/xpai/assets/js/85.bd4fb17d.js"><link rel="prefetch" href="/xpai/assets/js/86.8132e8a6.js"><link rel="prefetch" href="/xpai/assets/js/87.eef138b7.js"><link rel="prefetch" href="/xpai/assets/js/88.6a955e9d.js"><link rel="prefetch" href="/xpai/assets/js/89.35fe37ae.js"><link rel="prefetch" href="/xpai/assets/js/9.8b0545db.js"><link rel="prefetch" href="/xpai/assets/js/90.c663c19c.js"><link rel="prefetch" href="/xpai/assets/js/91.1b5a38b0.js"><link rel="prefetch" href="/xpai/assets/js/92.db3ae417.js"><link rel="prefetch" href="/xpai/assets/js/93.d5e4a4c0.js"><link rel="prefetch" href="/xpai/assets/js/94.295d99d0.js"><link rel="prefetch" href="/xpai/assets/js/95.49a70622.js"><link rel="prefetch" href="/xpai/assets/js/96.b0673c60.js"><link rel="prefetch" href="/xpai/assets/js/97.529dda13.js"><link rel="prefetch" href="/xpai/assets/js/98.b7c5d802.js"><link rel="prefetch" href="/xpai/assets/js/99.f0302d8a.js">
    <link rel="stylesheet" href="/xpai/assets/css/0.styles.79838e76.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/xpai/" class="home-link router-link-active"><img src="/xpai/img/logo.png" alt="x·π" class="logo"> <span class="site-name can-hide">x·π</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/xpai/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/xpai/back_end/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/xpai/pages/6d04efbdfa185c88916a6edec2b5bec9/" class="nav-link">Java基础篇</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/6b89cf0a450c5012bb4bdc12eea6bf40/" class="nav-link">Java框架篇</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/5f77f3ea97b75a5c9ffb0c5f1d7e3a72/" class="nav-link">CVS版本控制</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/70b389/" class="nav-link">数据库和缓存</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/8a0e5f/" class="nav-link">设计模式和架构</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/78189d/" class="nav-link">容器化和中间件</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/6d75fa6409b55e52a52a870a48f217fe/" class="nav-link">Linux运维和测试</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/1d539d/" class="nav-link">大数据和云计算</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/41fde4/" class="nav-link">工具和环境</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/xpai/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/xpai/pages/of4wa5/" class="nav-link">前端基础</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/9c53a1/" class="nav-link">前端框架</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/291a73/" class="nav-link">可视化</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/bbf7bd/" class="nav-link">UI设计和产品</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/0c01fa/" class="nav-link">Vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工作" class="dropdown-title"><a href="/xpai/work/" class="link-title">工作</a> <span class="title" style="display:none;">工作</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/xpai/pages/236765/" class="nav-link">个人</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/be82e4/" class="nav-link">公司</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具箱" class="dropdown-title"><a href="/xpai/tool/" class="link-title">工具箱</a> <span class="title" style="display:none;">工具箱</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/xpai/pages/d9f31f/" class="nav-link">在线工具</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/a9fdaa/" class="nav-link">后端工具</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/2910b4/" class="nav-link">前端工具</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="导航" class="dropdown-title"><a href="/xpai/navigation/" class="link-title">导航</a> <span class="title" style="display:none;">导航</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/xpai/pages/a0fb53/" class="nav-link">后端学习</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/c0ac49/" class="nav-link">前端学习</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/2e2565/" class="nav-link">软件资源</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/xpai/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/xpai/pages/284202/" class="nav-link">学习阅读</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/96d03e/" class="nav-link">面试经验</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/34a617/" class="nav-link">心情杂谈</a></li><li class="dropdown-item"><!----> <a href="/xpai/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/xpai/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/xpai/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/xpai/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/xpai/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><a href="/xpai/about/" class="nav-link">关于</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/Ezuy-Lee/RainzeDrawingBed/media/blogger-avatar.png"> <div class="blogger-info"><h3>雨小泽</h3> <span>一个北漂95后！正在潜心研究前端和Java后端技术，一边学习一边积累经验</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/xpai/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/xpai/back_end/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/xpai/pages/6d04efbdfa185c88916a6edec2b5bec9/" class="nav-link">Java基础篇</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/6b89cf0a450c5012bb4bdc12eea6bf40/" class="nav-link">Java框架篇</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/5f77f3ea97b75a5c9ffb0c5f1d7e3a72/" class="nav-link">CVS版本控制</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/70b389/" class="nav-link">数据库和缓存</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/8a0e5f/" class="nav-link">设计模式和架构</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/78189d/" class="nav-link">容器化和中间件</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/6d75fa6409b55e52a52a870a48f217fe/" class="nav-link">Linux运维和测试</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/1d539d/" class="nav-link">大数据和云计算</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/41fde4/" class="nav-link">工具和环境</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/xpai/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/xpai/pages/of4wa5/" class="nav-link">前端基础</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/9c53a1/" class="nav-link">前端框架</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/291a73/" class="nav-link">可视化</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/bbf7bd/" class="nav-link">UI设计和产品</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/0c01fa/" class="nav-link">Vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工作" class="dropdown-title"><a href="/xpai/work/" class="link-title">工作</a> <span class="title" style="display:none;">工作</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/xpai/pages/236765/" class="nav-link">个人</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/be82e4/" class="nav-link">公司</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具箱" class="dropdown-title"><a href="/xpai/tool/" class="link-title">工具箱</a> <span class="title" style="display:none;">工具箱</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/xpai/pages/d9f31f/" class="nav-link">在线工具</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/a9fdaa/" class="nav-link">后端工具</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/2910b4/" class="nav-link">前端工具</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="导航" class="dropdown-title"><a href="/xpai/navigation/" class="link-title">导航</a> <span class="title" style="display:none;">导航</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/xpai/pages/a0fb53/" class="nav-link">后端学习</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/c0ac49/" class="nav-link">前端学习</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/2e2565/" class="nav-link">软件资源</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/xpai/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/xpai/pages/284202/" class="nav-link">学习阅读</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/96d03e/" class="nav-link">面试经验</a></li><li class="dropdown-item"><!----> <a href="/xpai/pages/34a617/" class="nav-link">心情杂谈</a></li><li class="dropdown-item"><!----> <a href="/xpai/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/xpai/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/xpai/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/xpai/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/xpai/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><a href="/xpai/about/" class="nav-link">关于</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Java基础篇</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/xpai/pages/6d04efbdfa185c88916a6edec2b5bec9/" class="sidebar-link">《Java基础篇》</a></li><li><a href="/xpai/pages/5a32f8/" class="sidebar-link">Java注解详解以及自定义注解</a></li><li><a href="/xpai/pages/73cc08/" class="sidebar-link">Integer的缓存机制</a></li><li><a href="/xpai/pages/80fb83/" class="sidebar-link">自动拆装箱</a></li><li><a href="/xpai/pages/046fd8/" class="sidebar-link">Java基本数据类型</a></li><li><a href="/xpai/pages/584d81/" class="sidebar-link">字符串拼接的几种方式和区别</a></li><li><a href="/xpai/pages/601f0e/" class="sidebar-link">JVM还支持哪些语言</a></li><li><a href="/xpai/pages/fbca22/" class="sidebar-link">Java中的构造函数、变量、方法</a></li><li><a href="/xpai/pages/8b14b9/" class="sidebar-link">为什么说Java中只有值传递</a></li><li><a href="/xpai/pages/3cadb3/" class="sidebar-link">switch对String的支持</a></li><li><a href="/xpai/pages/04b78c/" class="sidebar-link">字符串池、Class常量池、运行时常量池</a></li><li><a href="/xpai/pages/506835/" class="sidebar-link">synchronized</a></li><li><a href="/xpai/pages/ddc883/" class="sidebar-link">final和static</a></li><li><a href="/xpai/pages/675c43/" class="sidebar-link">JVM内存结构、Java内存模型和Java对象模型</a></li><li><a href="/xpai/pages/9828de/" class="sidebar-link">Java内存模型是什么</a></li><li><a href="/xpai/pages/8bbca2/" class="sidebar-link">深入理解Java中的各种关键</a></li><li><a href="/xpai/pages/26cf66/" class="sidebar-link">replaceFirst、replaceAll、replace区别</a></li><li><a href="/xpai/pages/cba8cf/" class="sidebar-link">String字符串以及Substring的使用</a></li><li><a href="/xpai/pages/9d44df/" class="sidebar-link">如何正确定义接口的返回值类型及命名</a></li><li><a href="/xpai/pages/da7de8/" class="sidebar-link">Java经典排序算法</a></li><li><a href="/xpai/pages/0393d0/" class="sidebar-link">进程、线程以及多线程的认识</a></li><li><a href="/xpai/pages/b8ead7/" class="sidebar-link">多线程和线程池及其创建方式详解</a></li><li><a href="/xpai/pages/958afc/" aria-current="page" class="active sidebar-link">线程状态、优先级、停止、休眠、礼让、守护和同步机制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/xpai/pages/958afc/#线程的状态" class="sidebar-link">线程的状态</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/xpai/pages/958afc/#新建-new" class="sidebar-link">新建(NEW)</a></li><li class="sidebar-sub-header"><a href="/xpai/pages/958afc/#可运行-runnable" class="sidebar-link">可运行(RUNNABLE)</a></li><li class="sidebar-sub-header"><a href="/xpai/pages/958afc/#运行-running" class="sidebar-link">运行(RUNNING)</a></li><li class="sidebar-sub-header"><a href="/xpai/pages/958afc/#阻塞-blocked" class="sidebar-link">阻塞(BLOCKED)</a></li><li class="sidebar-sub-header"><a href="/xpai/pages/958afc/#死亡-dead" class="sidebar-link">死亡(DEAD)</a></li></ul></li><li class="sidebar-sub-header"><a href="/xpai/pages/958afc/#线程的优先级" class="sidebar-link">线程的优先级</a></li><li class="sidebar-sub-header"><a href="/xpai/pages/958afc/#线程优雅停止" class="sidebar-link">线程优雅停止</a></li><li class="sidebar-sub-header"><a href="/xpai/pages/958afc/#线程休眠" class="sidebar-link">线程休眠</a></li><li class="sidebar-sub-header"><a href="/xpai/pages/958afc/#线程礼让" class="sidebar-link">线程礼让</a></li><li class="sidebar-sub-header"><a href="/xpai/pages/958afc/#强制执行" class="sidebar-link">强制执行</a></li><li class="sidebar-sub-header"><a href="/xpai/pages/958afc/#线程守护" class="sidebar-link">线程守护</a></li><li class="sidebar-sub-header"><a href="/xpai/pages/958afc/#线程同步机制" class="sidebar-link">线程同步机制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/xpai/pages/958afc/#不需要synchronized的操作" class="sidebar-link">不需要synchronized的操作</a></li></ul></li></ul></li><li><a href="/xpai/pages/2f512e/" class="sidebar-link">JDK8新特性API总结</a></li><li><a href="/xpai/pages/05b71a/" class="sidebar-link">Object克隆方法解析</a></li><li><a href="/xpai/pages/966fe5/" class="sidebar-link">HTTPS分析与实战</a></li><li><a href="/xpai/pages/9a0202/" class="sidebar-link">进程状态与线程状态辨析</a></li><li><a href="/xpai/pages/982c8c/" class="sidebar-link">JavaSPI机制分析</a></li><li><a href="/xpai/pages/6857f3/" class="sidebar-link">Java CAS操作的ABA问题</a></li><li><a href="/xpai/pages/0bf169/" class="sidebar-link">Java调用Lua</a></li><li><a href="/xpai/pages/1d4c0c/" class="sidebar-link">Java压缩算法性能比较</a></li><li><a href="/xpai/pages/520813/" class="sidebar-link">对协程的一些理解</a></li><li><a href="/xpai/pages/f2c659/" class="sidebar-link">关于零拷贝的一点认识</a></li><li><a href="/xpai/pages/802508/" class="sidebar-link">如何设计一个安全的对外接口</a></li><li><a href="/xpai/pages/4acc7c/" class="sidebar-link">如何设计一个本地缓存</a></li><li><a href="/xpai/pages/b4f9f8/" class="sidebar-link">谈谈Java任务的并行处理</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java框架篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CVS版本控制</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库和缓存</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式和架构</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>容器化和中间件</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Linux运维和测试</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>大数据和云计算</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工具和环境</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法</span> <span class="arrow right"></span></p> <!----></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- 正方形 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1cd794fe><div class="articleInfo" data-v-1cd794fe><ul class="breadcrumbs" data-v-1cd794fe><li data-v-1cd794fe><a href="/xpai/" title="首页" class="iconfont icon-home router-link-active" data-v-1cd794fe></a></li> <li data-v-1cd794fe><a href="/xpai/back_end" title="后端-目录页" data-v-1cd794fe>后端</a></li> <li data-v-1cd794fe><a href="/xpai/back_end/#Java基础篇" title="后端#Java基础篇" data-v-1cd794fe>Java基础篇</a></li> <!----></ul> <div class="info" data-v-1cd794fe><div title="作者" class="author iconfont icon-touxiang" data-v-1cd794fe><a href="https://github.com/Ezuy-Lee" target="_blank" title="作者" class="beLink" data-v-1cd794fe>Rainze-Lee</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1cd794fe><a href="javascript:;" data-v-1cd794fe>2021-01-13</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">
          线程状态、优先级、停止、休眠、礼让、守护和同步机制
        </h1> <div class="page-slot page-slot-top"><!-- 固定100% * 90px可显示，max-height:90px未见显示-->
     <ins class="adsbygoogle"
          style="display:inline-block;width:100%;max-height:90px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6625304284"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="theme-vdoing-content content__default"><blockquote><p>这篇文章主要总结线程当中的一些关键知识点，可能有些东西在之前的文章中提到过，这里将重点进行说明。比如如何观察线程状态，测试线程的优先级、线程优雅停止、线程休眠、礼让、强制执行以及线程的守护和同步机制等。</p></blockquote> <h2 id="线程的状态"><a href="#线程的状态" class="header-anchor">#</a> 线程的状态</h2> <p>Java中的线程的生命周期大体可分为5种状态。</p> <p><img src="https://cdn.jsdelivr.net/gh/Ezuy-Lee/RainzeDrawingBed/media/7e76cc17-0ad5-3ff3-954e-1f83463519d1.jpg" alt=""></p> <h3 id="新建-new"><a href="#新建-new" class="header-anchor">#</a> <strong>新建(NEW)</strong></h3> <p>当用new操作符创建一个线程时， 例如new Thread(r)，线程还没有开始运行，此时线程处在新建状态。 当一个线程处于新生状态时，程序还没有开始运行线程中的代码</p> <h3 id="可运行-runnable"><a href="#可运行-runnable" class="header-anchor">#</a> <strong>可运行(RUNNABLE)</strong></h3> <p>一个新创建的线程并不自动开始运行，要执行线程，必须调用线程的start()方法。当线程对象调用start()方法即启动了线程，start()方法创建线程运行的系统资源，并调度线程运行run()方法。当start()方法返回后，线程就处于就绪状态。</p> <p>处于就绪状态的线程并不一定立即运行run()方法，线程还必须同其他线程竞争CPU时间，只有获得CPU时间才可以运行线程。因为在单CPU的计算机系统中，不可能同时运行多个线程，一个时刻仅有一个线程处于运行状态。因此此时可能有多个线程处于就绪状态。对多个处于就绪状态的线程是由Java运行时系统的线程调度程序(thread scheduler)来调度的。</p> <h3 id="运行-running"><a href="#运行-running" class="header-anchor">#</a> <strong>运行(RUNNING)</strong></h3> <p>当线程获得CPU时间后，它才进入运行状态，真正开始执行run()方法.</p> <h3 id="阻塞-blocked"><a href="#阻塞-blocked" class="header-anchor">#</a> <strong>阻塞(BLOCKED)</strong></h3> <p>线程运行过程中，可能由于各种原因进入阻塞状态， 所谓阻塞状态是正在运行的线程没有运行结束，暂时让出CPU，这时其他处于就绪状态的线程就可以获得CPU时间，进入运行状态。</p> <ol><li>等待阻塞：运行(running)的线程执行o.wait()方法，JVM会把该线程放入等待队列(waitting queue)中。</li> <li>同步阻塞：运行(running)的线程在获取对象的同步锁时，若该同步锁被别的线程占用，则JVM会把该线程放入锁池(lock pool)中。</li> <li>其他阻塞：运行(running)的线程执行Thread.sleep(long ms)或t.join()方法，或者发出了I/O请求时，JVM会把该线程置为阻塞状态。当sleep()状态超时、join()等待线程终止或者超时、或者I/O处理完毕时，线程重新转入可运行(runnable)状态。</li></ol> <h3 id="死亡-dead"><a href="#死亡-dead" class="header-anchor">#</a> <strong>死亡(DEAD)</strong></h3> <p>线程run()、main() 方法执行结束，或者因异常退出了run()方法，则该线程结束生命周期。死亡的线程<strong>不可再次复生</strong>。</p> <p>有两个原因会导致线程死亡：</p> <ol><li>run方法正常退出而自然死亡，</li> <li>一个未捕获的异常终止了run方法而使线程猝死。为了确定线程在当前是否存活着（就是要么是可运行的，要么是被阻塞了），需要使用isAlive方法。如果是可运行或被阻塞，这个方法返回true； 如果线程仍旧是new状态且不是可运行的， 或者线程死亡了，则返回false。</li></ol> <p>案例代码：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">rainzelee<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>thread<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @description:
 * @productName: java-core-base
 * @author: LYZ
 * @date: 2021/1/13 9:15
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThreadStatusDemo</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;测试线程状态&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ThreadStatusDemo</span> demo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadStatusDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>demo<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//启动前 new</span>
        <span class="token class-name">Thread<span class="token punctuation">.</span>State</span> state <span class="token operator">=</span> thread<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//启动线程</span>
        thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//睡眠测试阻塞</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//阻塞状态</span>
        <span class="token class-name">Thread<span class="token punctuation">.</span>State</span> threadState <span class="token operator">=</span> thread<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>threadState<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//终止线程，方法过时，不推荐这样使用，为了测试本案例我使用stop方法</span>
        thread<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Thread<span class="token punctuation">.</span>State</span> stopState <span class="token operator">=</span> thread<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>stopState<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//当线程死亡后启动线程会失败，也就是说 线程run()、main() 方法执行结束，或者因异常退出了run()方法，则该线程结束生命周期。死亡的线程**不可再次复生**。</span>
        thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><p>结果：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>NEW
测试线程状态
测试线程状态
测试线程状态
测试线程状态
测试线程状态
TERMINATED
TERMINATED
<span class="token class-name">Exception</span> in thread <span class="token string">&quot;main&quot;</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>IllegalThreadStateException</span>
	at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Thread</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">708</span><span class="token punctuation">)</span>
	at <span class="token class-name"><span class="token namespace">rainzelee<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>thread<span class="token punctuation">.</span>demo<span class="token punctuation">.</span></span>ThreadStatusDemo</span><span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">ThreadStatusDemo</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">51</span><span class="token punctuation">)</span>

<span class="token class-name">Process</span> finished <span class="token keyword">with</span> <span class="token namespace">exit</span> code <span class="token number">1</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>由上面的结果可以看出当线程死亡后，再次启动线程会报错。</p> <h2 id="线程的优先级"><a href="#线程的优先级" class="header-anchor">#</a> 线程的优先级</h2> <p>Java提供了一个线程调度器来监控程序启动后进去就绪状态的所有线程。线程调度器通过线程的优先级来决定调度哪些线程执行。一般来说，Java的线程调度器采用时间片轮转算法使多个线程轮转获得CPU的时间片。然而根据实际情况，每个线程的重要程序也不相同，有时候我们想让一些线程优先执行，那么我们可以将他的优先级调高一下，这样它们获得的时间片会多一些。</p> <p>多个线程处于就绪状态时，若这些线程的优先级相同，则线程调度器会按时间片轮转方式或独占方式来分配线程的执行时间。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code> <span class="token comment">/**
  * The minimum priority that a thread can have.
  */</span>
 <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> MIN_PRIORITY <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">/**
  * The default priority that is assigned to a thread.
  */</span>
 <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> NORM_PRIORITY <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>

 <span class="token comment">/**
  * The maximum priority that a thread can have.
  */</span>
 <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token keyword">int</span> MAX_PRIORITY <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>Java中线程优先级用1~10来表示，分为三个级别：</p> <ul><li><p>低优先级：1~4，其中类变量Thread.MIN_PRORITY最低，数值为1；</p></li> <li><p>默认优先级：如果一个线程没有指定优先级，默认优先级为5，由类变量Thread.NORM_PRORITY表示；</p></li> <li><p>高优先级：6~10，类变量Thread.MAX_PRORITY最高，数值为10。</p></li></ul> <p>注意：具有相同优先级的多个线程，若它们都为高优先级Thread.MAX_PRORITY，则每个线程都是独占式的，也就是这些线程将被顺序执行；若它们优先级不是高优先级，则这些线程将被同时执行，可以说是无序执行。</p> <p>代码：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">rainzelee<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>thread<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @description:
 * @productName: java-core-base
 * @author: LYZ
 * @date: 2021/1/13 9:32
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PriorityDemo</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>


    <span class="token keyword">public</span> <span class="token class-name">PriorityDemo</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;循环了：&quot;</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">&quot;次&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">//默认优先级 5</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;当前线程位：&quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;，优先级为：&quot;</span> <span class="token operator">+</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPriority</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PriorityDemo</span> thread1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityDemo</span><span class="token punctuation">(</span><span class="token string">&quot;thread1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PriorityDemo</span> thread2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityDemo</span><span class="token punctuation">(</span><span class="token string">&quot;thread2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PriorityDemo</span> thread3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityDemo</span><span class="token punctuation">(</span><span class="token string">&quot;thread3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//设置线程优先级</span>
        thread1<span class="token punctuation">.</span><span class="token function">setPriority</span><span class="token punctuation">(</span>MIN_PRIORITY<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 最小  1</span>
        thread3<span class="token punctuation">.</span><span class="token function">setPriority</span><span class="token punctuation">(</span>MAX_PRIORITY<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//最大 10</span>
        thread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread3<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>结果：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>当前线程位：main，优先级为：5
thread1循环了：1次
thread2循环了：1次
thread2循环了：2次
thread2循环了：3次
thread3循环了：1次
thread1循环了：2次
thread3循环了：2次
thread3循环了：3次
thread1循环了：3次

Process finished with exit code 0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>由结果可以看出，不是高优先级的线程就一定先比低优先级执行完，而是高优先级线程先执行的概率比低优先级的线程高。</p> <h2 id="线程优雅停止"><a href="#线程优雅停止" class="header-anchor">#</a> 线程优雅停止</h2> <p>我们都知道调用线程的stop() 方法会让线程停止或中断，但是我们不推荐使用，这种操作比较暴力，可能使一些清理性的工作得不到完成。还可能对锁定的内容进行解锁，容易造成数据不同步的问题，此方法已经过期也不推荐使用，下面介绍如何优雅的中断线程。</p> <ul><li>方式一(推荐)</li></ul> <p>使用退出标识，使得线程正常退出，即当run方法完成后进程终止。</p> <p>当run方法执行完后，线程就会退出。但有时run方法是永远不会结束的。如在服务端程序中使用线程进行监听客户端请求，或是其他的需要循环处理的任务。在这种情况下，一般是将这些任务放在一个循环中，如while循环。如果想让循环永远运行下去，可以使用while（true）{……}来处理。但要想使while循环在某一特定条件下退出，最直接的方法就是设一个boolean类型的标志，并通过设置这个标志为true或false来控制while循环是否退出。下面给出了一个利用退出标志终止线程的例子。</p> <p>代码：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">rainzelee<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>thread<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @description:
 * @productName: java-core-base
 * @author: LYZ
 * @date: 2021/1/13 9:43
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StopThreadDemo</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

    <span class="token comment">//标识</span>
    <span class="token keyword">public</span> <span class="token keyword">volatile</span> <span class="token keyword">boolean</span> exit <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>exit<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token class-name">StopThreadDemo</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StopThreadDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span> thread1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>thread<span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;线程已经启动&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 主线程延迟5秒</span>
        thread<span class="token punctuation">.</span>exit <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  <span class="token comment">// 终止线程thread</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;线程退出!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>



<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>在上面代码中定义了一个退出标志exit，当exit为true时，while循环退出，exit的默认值为false.在定义exit时，使用了一个Java关键字volatile，这个关键字的目的是使exit同步，也就是说在同一时刻只能由一个线程来修改exit的值，</p> <ul><li>方式二（不推荐）</li></ul> <p>使用stop方法可以强行终止正在运行或挂起的线程。我们可以使用如下的代码来终止线程：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>thread<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>方式三</p> <p>使用interrupt方法来终端线程可分为两种情况：</p> <p>（1）线程处于阻塞状态，如使用了sleep方法。</p> <p>（2）使用while（！isInterrupted（））{……}来判断线程是否被中断。</p></li></ul> <p>在第一种情况下使用interrupt方法，sleep方法将抛出一个InterruptedException例外，而在第二种情况下线程将直接退出。下面的代码演示了在第一种情况下使用interrupt方法。</p> <p>代码：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">rainzelee<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>thread<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @description:
 * @productName: java-core-base
 * @author: LYZ
 * @date: 2021/1/13 9:53
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StopThreadDemo2</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">50000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 延迟50秒</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StopThreadDemo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;在50秒之内按任意键中断线程!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread<span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;线程已经退出!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>在调用interrupt方法后， sleep方法抛出异常，然后输出错误信息：sleep interrupted.</p> <p>注意：</p> <p>在Thread类中有两个方法可以判断线程是否通过interrupt方法被终止。一个是静态的方法interrupted（），一个是非静态的方法isInterrupted（），这两个方法的区别是interrupted用来判断当前线是否被中断，而isInterrupted可以用来判断其他线程是否被中断。因此，while （！isInterrupted（））也可以换成while （！Thread.interrupted（））。</p> <h2 id="线程休眠"><a href="#线程休眠" class="header-anchor">#</a> 线程休眠</h2> <p>线程休眠的目的是使线程让出CPU的最简单的做法之一，线程休眠时候，会将CPU资源交给其他线程，以便能轮换执行，当休眠一定时间后，线程会苏醒，进入准备状态等待执行。</p> <p>线程休眠的方法是Thread.sleep(long millis)和Thread.sleep(long millis, int nanos)，均为静态方法，那调用sleep休眠的哪个线程呢？简单说，哪个线程调用sleep，就休眠哪个线程。</p> <p>代码：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">rainzelee<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>thread<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @description:
 * @productName: java-core-base
 * @author: LYZ
 * @date: 2021/1/13 10:01
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThreadSleepDemo</span> <span class="token punctuation">{</span>

    <span class="token keyword">class</span> <span class="token class-name">MyThread1</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;线程1第&quot;</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">&quot;次执行！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">class</span> <span class="token class-name">MyRunnable</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;线程2第&quot;</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">&quot;次执行！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ThreadSleepDemo</span> sleep <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadSleepDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span> t1 <span class="token operator">=</span> sleep<span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token class-name">MyThread1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span> t2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>sleep<span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token class-name">MyRunnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p>结果：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>线程1第0次执行！
线程2第0次执行！
线程1第1次执行！
线程2第1次执行！
线程2第2次执行！
线程1第2次执行！

Process finished with exit code 0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>从上面的结果输出可以看出，无法精准保证线程执行次序。</p> <h2 id="线程礼让"><a href="#线程礼让" class="header-anchor">#</a> 线程礼让</h2> <p>通过yield()方法，将当前进程停下，换成就绪状态，让系统的调度器重新调度一次。</p> <p>与sleep()方法相似，但yield()方法不会阻塞该线程，之后该线程与其他线程是相对公平的。调度谁看系统，有可能还是调度它自己。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">rainzelee<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>thread<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @description:
 * @productName: java-core-base
 * @author: LYZ
 * @date: 2021/1/13 10:04
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">YieldThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token comment">// 定义一个有参的构造方法</span>
    <span class="token keyword">public</span> <span class="token class-name">YieldThread</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调用父类的构造方法</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;---&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;线程让步:\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token keyword">yield</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 线程运行到此，作出让步</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 创建两个线程</span>
        <span class="token class-name">Thread</span> t1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">YieldThread</span><span class="token punctuation">(</span><span class="token string">&quot;线程A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span> t2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">YieldThread</span><span class="token punctuation">(</span><span class="token string">&quot;线程B&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 开启两个线程</span>
        t1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>打印结果：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>线程A---0
线程B---0
线程A---1
线程B---1
线程A---2
线程B---2
线程A---3
线程B---3
线程让步:
线程让步:
线程B---4
线程B---5
线程B---6
线程B---7
线程A---4
线程B---8
线程A---5
线程B---9
线程A---6
线程A---7
线程A---8
线程A---9

Process finished with exit code 0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>通过结果可以看到线程让步之后，有可能系统调度的是别的线程，有可能还是自己。</p> <h2 id="强制执行"><a href="#强制执行" class="header-anchor">#</a> 强制执行</h2> <p>多个线程同时运行的时候我们可以指定一某个线程，让这个线程优先执行，也就是其他的线程让出CPU资源，直到指定的线程执行完毕，其他线程恢复正常工作。强制执行的方法就是join()，join()方法存在方法重载，这里说明一下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 线程强制执行完毕</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">join</span><span class="token punctuation">(</span><span class="token keyword">long</span> millis<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// 线程强制执行若干毫秒</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">join</span><span class="token punctuation">(</span><span class="token keyword">long</span> millis<span class="token punctuation">,</span> <span class="token keyword">int</span> nanos<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// 线程强制执行若干毫秒及纳秒</span>
<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>代码：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">rainzelee<span class="token punctuation">.</span>blog<span class="token punctuation">.</span>thread<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @description:
 * @productName: java-core-base
 * @author: LYZ
 * @date: 2021/1/13 10:07
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThreadJoin</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token class-name">Thread</span> main <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">MyThreadJoin</span><span class="token punctuation">(</span><span class="token class-name">Thread</span> main<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>main <span class="token operator">=</span> main<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    main<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;执行， i = &quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span> mainThread <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获得主线程对象</span>

        <span class="token class-name">MyThreadJoin</span> thread8 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThreadJoin</span><span class="token punctuation">(</span>mainThread<span class="token punctuation">)</span><span class="token punctuation">;</span>
        thread8<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 延缓程序执行速度</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;执行， i = &quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>




<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p>这里我们设置了两个线程，其中子线程thread8循环打印20次，在第11次的时候主线程对象使用join()方法，使得主线程获得CPU资源，加下来的时间都让给主线程，主线程中开始循环打印20次，每次间隔1秒，打印完20次，CPU资源重新还给子线程，将子线程剩余的循环执行完毕。</p> <h2 id="线程守护"><a href="#线程守护" class="header-anchor">#</a> 线程守护</h2> <p>Java程序入口就是由JVM启动<code>main</code>线程，<code>main</code>线程又可以启动其他线程。当所有线程都运行结束时，JVM退出，进程结束。</p> <p>如果有一个线程没有退出，JVM进程就不会退出。所以，必须保证所有线程都能及时结束。</p> <p>但是有一种线程的目的就是无限循环，例如，一个定时触发任务的线程：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">TimerThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">LocalTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>如果这个线程不结束，JVM进程就无法结束。问题是，由谁负责结束这个线程？</p> <p>然而这类线程经常没有负责人来负责结束它们。但是，当其他线程结束时，JVM进程又必须要结束，怎么办？</p> <p>答案是使用守护线程（Daemon Thread）。</p> <p>守护线程是指为其他线程服务的线程。在JVM中，所有非守护线程都执行完毕后，无论有没有守护线程，虚拟机都会自动退出。</p> <p>因此，JVM退出时，不必关心守护线程是否已结束。</p> <p>如何创建守护线程呢？方法和普通线程一样，只是在调用<code>start()</code>方法前，调用<code>setDaemon(true)</code>把该线程标记为守护线程：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
t<span class="token punctuation">.</span><span class="token function">setDaemon</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在守护线程中，编写代码要注意：守护线程不能持有任何需要关闭的资源，例如打开文件等，因为虚拟机退出时，守护线程没有任何机会来关闭文件，这会导致数据丢失。</p> <h2 id="线程同步机制"><a href="#线程同步机制" class="header-anchor">#</a> 线程同步机制</h2> <p>当多个线程同时运行时，线程的调度由操作系统决定，程序本身无法决定。因此，任何一个线程都有可能在任何指令处被操作系统暂停，然后在某个时间段后继续执行。</p> <p>这个时候，有个单线程模型下不存在的问题就来了：如果多个线程同时读写共享变量，会出现数据不一致的问题。</p> <p>例子:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> add <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AddThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> dec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DecThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        add<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dec<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        add<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dec<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">AddThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token class-name">Counter</span><span class="token punctuation">.</span>count <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">DecThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token class-name">Counter</span><span class="token punctuation">.</span>count <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>上面的代码很简单，两个线程同时对一个<code>int</code>变量进行操作，一个加10000次，一个减10000次，最后结果应该是0，但是，每次运行，结果实际上都是不一样的。</p> <p>这是因为对变量进行读取和写入时，结果要正确，必须保证是原子操作。原子操作是指不能被中断的一个或一系列操作。</p> <p>例如，对于语句：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>n = n + 1;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>看上去是一行语句，实际上对应了3条指令：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ILOAD
IADD
ISTORE
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>我们假设<code>n</code>的值是<code>100</code>，如果两个线程同时执行<code>n = n + 1</code>，得到的结果很可能不是<code>102</code>，而是<code>101</code>，原因在于：</p> <div class="language-ascii line-numbers-mode"><pre class="language-text"><code>┌───────┐    ┌───────┐
│Thread1│    │Thread2│
└───┬───┘    └───┬───┘
    │            │
    │ILOAD (100) │
    │            │ILOAD (100)
    │            │IADD
    │            │ISTORE (101)
    │IADD        │
    │ISTORE (101)│
    ▼            ▼
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>如果线程1在执行<code>ILOAD</code>后被操作系统中断，此刻如果线程2被调度执行，它执行<code>ILOAD</code>后获取的值仍然是<code>100</code>，最终结果被两个线程的<code>ISTORE</code>写入后变成了<code>101</code>，而不是期待的<code>102</code>。</p> <p>这说明多线程模型下，要保证逻辑正确，对共享变量进行读写时，必须保证一组指令以原子方式执行：即某一个线程执行时，其他线程必须等待：</p> <div class="language-ascii line-numbers-mode"><pre class="language-text"><code>┌───────┐     ┌───────┐
│Thread1│     │Thread2│
└───┬───┘     └───┬───┘
    │             │
    │-- lock --   │
    │ILOAD (100)  │
    │IADD         │
    │ISTORE (101) │
    │-- unlock -- │
    │             │-- lock --
    │             │ILOAD (101)
    │             │IADD
    │             │ISTORE (102)
    │             │-- unlock --
    ▼             ▼
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>通过加锁和解锁的操作，就能保证3条指令总是在一个线程执行期间，不会有其他线程会进入此指令区间。即使在执行期线程被操作系统中断执行，其他线程也会因为无法获得锁导致无法进入此指令区间。只有执行线程将锁释放后，其他线程才有机会获得锁并执行。这种加锁和解锁之间的代码块我们称之为临界区（Critical Section），任何时候临界区最多只有一个线程能执行。</p> <p>可见，保证一段代码的原子性就是通过加锁和解锁实现的。Java程序使用<code>synchronized</code>关键字对一个对象进行加锁：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>synchronized(lock) {
    n = n + 1;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>synchronized</code>保证了代码块在任意时刻最多只有一个线程能执行。我们把上面的代码用<code>synchronized</code>改写如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> add <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AddThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> dec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DecThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        add<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dec<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        add<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dec<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Object</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">AddThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span>lock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Counter</span><span class="token punctuation">.</span>count <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">DecThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span>lock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Counter</span><span class="token punctuation">.</span>count <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>注意到代码：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span>lock<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 获取锁</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span> <span class="token comment">// 释放锁</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>它表示用<code>Counter.lock</code>实例作为锁，两个线程在执行各自的<code>synchronized(Counter.lock) { ... }</code>代码块时，必须先获得锁，才能进入代码块进行。执行结束后，在<code>synchronized</code>语句块结束会自动释放锁。这样一来，对<code>Counter.count</code>变量进行读写就不可能同时进行。上述代码无论运行多少次，最终结果都是0。</p> <p>使用<code>synchronized</code>解决了多线程同步访问共享变量的正确性问题。但是，它的缺点是带来了性能下降。因为<code>synchronized</code>代码块无法并发执行。此外，加锁和解锁需要消耗一定的时间，所以，<code>synchronized</code>会降低程序的执行效率。</p> <p>我们来概括一下如何使用<code>synchronized</code>：</p> <ol><li>找出修改共享变量的线程代码块。</li> <li>选择一个共享实例作为锁；</li> <li>使用<code>synchronized(lockObject) { ... }</code>。</li></ol> <p>在使用<code>synchronized</code>的时候，不必担心抛出异常。因为无论是否有异常，都会在<code>synchronized</code>结束处正确释放锁：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">+=</span> m<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token comment">// 无论有无异常，都会在此释放锁</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>我们再来看一个错误使用<code>synchronized</code>的例子：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> add <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AddThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> dec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DecThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        add<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dec<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        add<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dec<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Object</span> lock1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Object</span> lock2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">AddThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span>lock1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Counter</span><span class="token punctuation">.</span>count <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">DecThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span>lock2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Counter</span><span class="token punctuation">.</span>count <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>结果并不是0，这是因为两个线程各自的<code>synchronized</code>锁住的<em>不是同一个对象</em>！这使得两个线程各自都可以同时获得锁：因为JVM只保证同一个锁在任意时刻只能被一个线程获取，但两个不同的锁在同一时刻可以被两个线程分别获取。</p> <p>因此，使用<code>synchronized</code>的时候，获取到的是哪个锁非常重要。锁对象如果不对，代码逻辑就不对。</p> <p>我们再看一个例子：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> ts <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">new</span> <span class="token class-name">AddStudentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DecStudentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">AddTeacherThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DecTeacherThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> t <span class="token operator">:</span> ts<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> t <span class="token operator">:</span> ts<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            t<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span>studentCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span>teacherCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Object</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> studentCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> teacherCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">AddStudentThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span>lock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Counter</span><span class="token punctuation">.</span>studentCount <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">DecStudentThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span>lock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Counter</span><span class="token punctuation">.</span>studentCount <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">AddTeacherThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span>lock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Counter</span><span class="token punctuation">.</span>teacherCount <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">DecTeacherThread</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span>lock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Counter</span><span class="token punctuation">.</span>teacherCount <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><p>上述代码的4个线程对两个共享变量分别进行读写操作，但是使用的锁都是<code>Counter.lock</code>这一个对象，这就造成了原本可以并发执行的<code>Counter.studentCount += 1</code>和<code>Counter.teacherCount += 1</code>，现在无法并发执行了，执行效率大大降低。实际上，需要同步的线程可以分成两组：<code>AddStudentThread</code>和<code>DecStudentThread</code>，<code>AddTeacherThread</code>和<code>DecTeacherThread</code>，组之间不存在竞争，因此，应该使用两个不同的锁，即：</p> <p><code>AddStudentThread</code>和<code>DecStudentThread</code>使用<code>lockStudent</code>锁：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span>lockStudent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>AddTeacherThread</code>和<code>DecTeacherThread</code>使用<code>lockTeacher</code>锁：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span>lockTeacher<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这样才能最大化地提高执行效率。</p> <h3 id="不需要synchronized的操作"><a href="#不需要synchronized的操作" class="header-anchor">#</a> 不需要synchronized的操作</h3> <p>JVM规范定义了几种原子操作：</p> <ul><li><p>基本类型（<code>long</code>和<code>double</code>除外）赋值，例如：<code>int n = m</code>；</p></li> <li><p>引用类型赋值，例如：<code>List&lt;String&gt; list = anotherList</code>。</p></li></ul> <p><code>long</code>和<code>double</code>是64位数据，JVM没有明确规定64位赋值操作是不是一个原子操作，不过在x64平台的JVM是把<code>long</code>和<code>double</code>的赋值作为原子操作实现的。</p> <p>单条原子操作的语句不需要同步。例如：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">int</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">synchronized</span><span class="token punctuation">(</span>lock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> m<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>就不需要同步。</p> <p>对引用也是类似。例如：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>上述赋值语句并不需要同步。</p> <p>但是，如果是多行赋值语句，就必须保证是同步操作，例如：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Pair</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> first<span class="token punctuation">;</span>
    <span class="token keyword">int</span> last<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">int</span> first<span class="token punctuation">,</span> <span class="token keyword">int</span> last<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>first <span class="token operator">=</span> first<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>last <span class="token operator">=</span> last<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>有些时候，通过一些巧妙的转换，可以把非原子操作变为原子操作。例如，上述代码如果改造成：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Pair</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pair<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">int</span> first<span class="token punctuation">,</span> <span class="token keyword">int</span> last<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ps <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> first<span class="token punctuation">,</span> last <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>pair <span class="token operator">=</span> ps<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>就不再需要同步，因为<code>this.pair = ps</code>是引用赋值的原子操作。而语句：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ps <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> first<span class="token punctuation">,</span> last <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这里的<code>ps</code>是方法内部定义的局部变量，每个线程都会有各自的局部变量，互不影响，并且互不可见，并不需要同步。</p> <p>小结：</p> <p>多线程同时读写共享变量时，会造成逻辑错误，因此需要通过<code>synchronized</code>同步；</p> <p>同步的本质就是给指定对象加锁，加锁后才能继续执行后续代码；</p> <p>注意加锁对象必须是同一个实例；</p> <p>对JVM定义的单个原子操作不需要同步。</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>本文关于线程同步机制由于作者理解不是很深刻，故参考了大佬<a href="https://www.liaoxuefeng.com/wiki/1252599548343744/1306580844806178" target="_blank" rel="noopener noreferrer">廖雪峰的一篇文章<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，相关代码已经同步到 <a href="https://github.com/Ezuy-Lee/java-core-base" target="_blank" rel="noopener noreferrer">GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></div></div> <div class="page-slot page-slot-bottom"><!-- 横向自适应 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><!----> <div class="tags"><a href="/xpai/tags/?tag=%E5%A4%9A%E7%BA%BF%E7%A8%8B" title="标签">#多线程</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021/01/13, 08:35:24</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/xpai/pages/b8ead7/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">多线程和线程池及其创建方式详解</div></a> <a href="/xpai/pages/2f512e/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">JDK8新特性API总结</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/xpai/pages/b8ead7/" class="prev">多线程和线程池及其创建方式详解</a></span> <span class="next"><a href="/xpai/pages/2f512e/">JDK8新特性API总结</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/xpai/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/xpai/pages/f8e1fa/"><div>开发者如何在技术+管理的路上越走越宽？</div></a> <span>06-27</span></dt></dl><dl><dd>02</dd> <dt><a href="/xpai/pages/37e0fd/"><div>RocketMQ生产者流程篇</div></a> <span>06-27</span></dt></dl><dl><dd>03</dd> <dt><a href="/xpai/pages/a81d2c/"><div>你对线程隔离的理解</div></a> <span>06-27</span></dt></dl> <dl><dd></dd> <dt><a href="/xpai/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:619147075@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/Ezuy-Lee/" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=966099149" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2020-2021
    <span>Rainze-Lee | <a href="https://github.com/Ezuy-Lee/Rainze-Blog/blob/main/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><i class="close-but">×</i> <div><!-- 固定160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;max-width:160px;max-height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><div></div></div></div>
    <script src="/xpai/assets/js/app.463a16ef.js" defer></script><script src="/xpai/assets/js/2.86da3580.js" defer></script><script src="/xpai/assets/js/34.a5238ebc.js" defer></script>
  </body>
</html>