(window.webpackJsonp=window.webpackJsonp||[]).push([[123],{550:function(e,s,a){"use strict";a.r(s);var r=a(15),t=Object(r.a)({},(function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"rocketmq整体结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rocketmq整体结构"}},[e._v("#")]),e._v(" RocketMQ整体结构")]),e._v(" "),a("p",[a("img",{attrs:{src:"https://oscimg.oschina.net/oscnet/b95324fc1ac6246060bdf2bb1e0edba92e3.jpg",alt:""}})]),e._v(" "),a("p",[e._v("如上图所示，整体可以分成4个角色，分别是：Producer，Consumer，Broker以及NameServer；")]),e._v(" "),a("h3",{attrs:{id:"_1-nameserver"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-nameserver"}},[e._v("#")]),e._v(" 1.NameServer")]),e._v(" "),a("p",[e._v("可以理解为是消息队列的协调者，Broker向它注册路由信息，同时Client向其获取路由信息，如果使用过Zookeeper，就比较容易理解了，但是功能比Zookeeper弱；"),a("br"),e._v("\nNameServer本身是没有状态的，并且多个NameServer直接并没有通信，可以横向扩展多台，Broker会和每一台NameServer建立长连接；")]),e._v(" "),a("h3",{attrs:{id:"_2-broker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-broker"}},[e._v("#")]),e._v(" 2.Broker")]),e._v(" "),a("p",[e._v("Broker是RocketMQ的核心，提供了消息的接收，存储，拉取等功能，一般都需要保证Broker的高可用，所以会配置Broker Slave，当Master挂掉之后，Consumer然后可以消费Slave；"),a("br"),e._v("\nBroker分为Master和Slave，一个Master可以对应多个Slave，Master与Slave的对应关系通过指定相同的BrokerName，不同的BrokerId来定义，BrokerId为0表示Master，非0表示Slave；")]),e._v(" "),a("h3",{attrs:{id:"_3-producer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-producer"}},[e._v("#")]),e._v(" 3.Producer")]),e._v(" "),a("p",[e._v("消息队列的生产者，需要与NameServer建立连接，从NameServer获取Topic路由信息，并向提供Topic服务的Broker Master建立连接；Producer无状态，看集群部署；")]),e._v(" "),a("h3",{attrs:{id:"_4-consumer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-consumer"}},[e._v("#")]),e._v(" 4.Consumer")]),e._v(" "),a("p",[e._v("消息队列的消费者，同样与NameServer建立连接，从NameServer获取Topic路由信息，并向提供Topic服务的Broker Master，Slave建立连接；")]),e._v(" "),a("h3",{attrs:{id:"_5-topic和message-queue"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-topic和message-queue"}},[e._v("#")]),e._v(" 5.Topic和Message Queue")]),e._v(" "),a("p",[e._v("在介绍完以上4个角色以后，还需要重点介绍一下上面提到的Topic和Message Queue；字面意思就是主题，用来区分不同类型的消息，发送和接收消息前都需要先创建Topic，针对Topic来发送和接收消息，为了提高性能和吞吐量，引入了Message Queue，一个Topic可以设置一个或多个Message Queue，有点类似kafka的分区(Partition)，这样消息就可以并行往各个Message Queue发送消息，消费者也可以并行的从多个Message Queue读取消息；")]),e._v(" "),a("h2",{attrs:{id:"单机配置和部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#单机配置和部署"}},[e._v("#")]),e._v(" 单机配置和部署")]),e._v(" "),a("p",[e._v("以下部署在"),a("strong",[e._v("centos7，jdk1.8，rocketmq4.3.2")]),e._v("；启动RocketMQ的顺序是先启动NameServer，然后再启动Broker；")]),e._v(" "),a("h3",{attrs:{id:"_1-nameserver启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-nameserver启动"}},[e._v("#")]),e._v(" 1.NameServer启动")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("[root@localhost bin]# ./mqnamesrv\nJava HotSpot(TM) 64-Bit Server VM warning: Using the DefNew young collector with the CMS collector is deprecated and will likely be removed in a future release\nJava HotSpot(TM) 64-Bit Server VM warning: UseCMSCompactAtFullCollection is deprecated and will likely be removed in a future release.\nThe Name Server boot success. serializeType=JSON\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])]),a("p",[e._v("如上日志表示启动成功，默认端口为9876；")]),e._v(" "),a("h3",{attrs:{id:"_2-broker启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-broker启动"}},[e._v("#")]),e._v(" 2.Broker启动")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("[root@localhost bin]# ./mqbroker\nJava HotSpot(TM) 64-Bit Server VM warning: INFO: os::commit_memory(0x00000005c0000000, 8589934592, 0) failed; error='Cannot allocate memory' (errno=12)\n#\n# There is insufficient memory for the Java Runtime Environment to continue.\n# Native memory allocation (mmap) failed to map 8589934592 bytes for committing reserved memory.\n# An error report file with more information is saved as:\n# /root/rocketmq-all-4.3.2-bin-release/bin/hs_err_pid3977.log\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br")])]),a("p",[e._v("启动失败，报内存不足，主要是rocketmq默认配置的启动参数值比较大，修改runbroker.sh即可")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('[root@localhost bin]# vi runbroker.sh\n\nJAVA_OPT="${JAVA_OPT} -server -Xms8g -Xmx8g -Xmn4g"\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("p",[e._v("默认配置的可用内存为8g，虚拟机内存不够，修改为如下即可")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('JAVA_OPT="${JAVA_OPT} -server -Xms128m -Xmx128m -Xmn128m"\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("再次启动，日志如下，表示启动成功，默认端口为10911；")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("[root@localhost bin]# ./mqbroker\nThe broker[localhost.localdomain, 192.168.237.128:10911] boot success. serializeType=JSON\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("h3",{attrs:{id:"_3-简单测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-简单测试"}},[e._v("#")]),e._v(" 3.简单测试")]),e._v(" "),a("h4",{attrs:{id:"_3-1生产者"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1生产者"}},[e._v("#")]),e._v(" 3.1生产者")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('public class SyncProducer {\n\n     public static void main(String[] args) throws Exception {\n           // 构造Producer\n           DefaultMQProducer producer = new DefaultMQProducer("ProducerGroupName");\n           producer.setNamesrvAddr("192.168.237.128:9876");\n           // 初始化Producer，整个应用生命周期内，只需要初始化1次\n           producer.start();\n           for (int i = 0; i < 100; i++) {\n                Message msg = new Message("TopicTest", "TagA",\n                           ("Hello RocketMQ" + i).getBytes(RemotingHelper.DEFAULT_CHARSET));\n                SendResult sendResult = producer.send(msg);\n                System.out.println(sendResult);\n           }\n           producer.shutdown();\n     }\n}\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br"),a("span",{staticClass:"line-number"},[e._v("16")]),a("br"),a("span",{staticClass:"line-number"},[e._v("17")]),a("br")])]),a("p",[e._v("创建了一个DefaultMQProducer对象，同时设置了GroupName和NameServer地址，然后创建Message消息通过DefaultMQProducer将消息发送出去，返回一个SendResult对象；")]),e._v(" "),a("h4",{attrs:{id:"_3-2消费者"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2消费者"}},[e._v("#")]),e._v(" 3.2消费者")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('public class PushConsumer {\n\n     public static void main(String[] args) throws MQClientException {\n           DefaultMQPushConsumer consumer = new DefaultMQPushConsumer("please rename to unique group name");\n           consumer.setNamesrvAddr("192.168.237.128:9876");\n           consumer.setConsumeFromWhere(ConsumeFromWhere.CONSUME_FROM_FIRST_OFFSET);\n           consumer.subscribe("TopicTest", "*");\n           consumer.registerMessageListener(new MessageListenerConcurrently() {\n                public ConsumeConcurrentlyStatus consumeMessage(List<MessageExt> msgs,\n                ConsumeConcurrentlyContext context) {\n                     System.out.printf(Thread.currentThread().getName() + "Receive New Messages :" + msgs + "%n");\n                     return ConsumeConcurrentlyStatus.CONSUME_SUCCESS;\n                }\n           });\n           consumer.start();\n     }\n}\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br"),a("span",{staticClass:"line-number"},[e._v("16")]),a("br"),a("span",{staticClass:"line-number"},[e._v("17")]),a("br")])]),a("p",[e._v("同样指定了GroupName和NameServer地址，订阅了Topic；")]),e._v(" "),a("h4",{attrs:{id:"_3-3运行测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3运行测试"}},[e._v("#")]),e._v(" 3.3运行测试")]),e._v(" "),a("p",[e._v("直接运行生产者报如下错误：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('Exception in thread "main" org.apache.rocketmq.client.exception.MQClientException: No route info of this topic, TopicTest\nSee http://rocketmq.apache.org/docs/faq/ for further details.\n    at org.apache.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendDefaultImpl(DefaultMQProducerImpl.java:634)\n    at org.apache.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:1253)\n    at org.apache.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:1203)\n    at org.apache.rocketmq.client.producer.DefaultMQProducer.send(DefaultMQProducer.java:214)\n    at com.rocketmq.SyncProducer.main(SyncProducer.java:26)\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br")])]),a("p",[e._v('错误显示"没有此Topic的路由信息"，也就是生产者在发送消息的时候没有获取到路由信息，找不到指定的Broker,可能的原因：'),a("br"),e._v("\n1.Broker没有正确连接NameServer"),a("br"),e._v("\n2.Producer没有连接NameServer"),a("br"),e._v("\n3.Topic没有被正确创建"),a("br"),e._v("\nSyncProducer中指定了NameServer的地址，同时RocketMQ默认情况下会自动创建Topic，所以原因是Broker没有注册到NameServer，重新指定NameServer再启动：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("[root@localhost bin]# ./mqbroker -n localhost:9876\nThe broker[localhost.localdomain, 192.168.237.128:10911] boot success. serializeType=JSON and name server is localhost:9876\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("再次运行SyncProducer，日志如下：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("SendResult [sendStatus=SEND_OK, msgId=0A0D53073B6073D16E933086C4C60000, offsetMsgId=C0A8ED8000002A9F000000000000229C, messageQueue=MessageQueue[topic=TopicTest, brokerName=localhost.localdomain, queueId=1], queueOffset=11]\n\nSendResult [sendStatus=SEND_OK, msgId=0A0D53073B6073D16E933086C4CD0001, offsetMsgId=C0A8ED8000002A9F000000000000234D, messageQueue=MessageQueue [topic=TopicTest, brokerName=localhost.localdomain, queueId=2], queueOffset=9]\n\nSendResult [sendStatus=SEND_OK, msgId=0A0D53073B6073D16E933086C4D90002, offsetMsgId=C0A8ED8000002A9F00000000000023FE, messageQueue=MessageQueue[topic=TopicTest, brokerName=localhost.localdomain, queueId=3], queueOffset=9]\n\nSendResult [sendStatus=SEND_OK, msgId=0A0D53073B6073D16E933086C4E80003, offsetMsgId=C0A8ED8000002A9F00000000000024AF, messageQueue=MessageQueue [topic=TopicTest, brokerName=localhost.localdomain, queueId=0], queueOffset=11]\n\nSendResult [sendStatus=SEND_OK, msgId=0A0D53073B6073D16E933086C4F40004, offsetMsgId=C0A8ED8000002A9F0000000000002560, messageQueue=MessageQueue [topic=TopicTest, brokerName=localhost.localdomain, queueId=1], queueOffset=12]\n\nSendResult [sendStatus=SEND_OK, msgId=0A0D53073B6073D16E933086C4F70005, offsetMsgId=C0A8ED8000002A9F0000000000002611, messageQueue=MessageQueue [topic=TopicTest, brokerName=localhost.localdomain, queueId=2], queueOffset=10]\n\nSendResult [sendStatus=SEND_OK, msgId=0A0D53073B6073D16E933086C5030006, offsetMsgId=C0A8ED8000002A9F00000000000026C2, messageQueue=MessageQueue [topic=TopicTest, brokerName=localhost.localdomain, queueId=3], queueOffset=10]\n\nSendResult [sendStatus=SEND_OK, msgId=0A0D53073B6073D16E933086C5070007, offsetMsgId=C0A8ED8000002A9F0000000000002773, messageQueue=MessageQueue [topic=TopicTest, brokerName=localhost.localdomain, queueId=0], queueOffset=12]\n\nSendResult [sendStatus=SEND_OK, msgId=0A0D53073B6073D16E933086C50A0008, offsetMsgId=C0A8ED8000002A9F0000000000002824, messageQueue=MessageQueue [topic=TopicTest, brokerName=localhost.localdomain, queueId=1], queueOffset=13]\n\nSendResult [sendStatus=SEND_OK, msgId=0A0D53073B6073D16E933086C50D0009, offsetMsgId=C0A8ED8000002A9F00000000000028D5, messageQueue=MessageQueue [topic=TopicTest, brokerName=localhost.localdomain, queueId=2], queueOffset=11]\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br"),a("span",{staticClass:"line-number"},[e._v("16")]),a("br"),a("span",{staticClass:"line-number"},[e._v("17")]),a("br"),a("span",{staticClass:"line-number"},[e._v("18")]),a("br"),a("span",{staticClass:"line-number"},[e._v("19")]),a("br")])]),a("p",[e._v("消费者使用的是push模式，可以实时接受消息：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("ConsumeMessageThread_13Receive New Messages :[MessageExt [queueId=1, storeSize=177,queueOffset=11, sysFlag=0, bornTimestamp=1547086138566, bornHost=/192.168.237.1:53524, storeTimestamp=1547139430770, storeHost=/192.168.237.128:10911, msgId=C0A8ED8000002A9F000000000000229C, commitLogOffset=8860, bodyCRC=705268097, reconsumeTimes=0, preparedTransactionOffset=0, toString()=Message{topic='TopicTest', flag=0, properties={MIN_OFFSET=0, MAX_OFFSET=12, CONSUME_START_TIME=1547086138573, UNIQ_KEY=0A0D53073B6073D16E933086C4C60000, WAIT=true, TAGS=TagA}, body=[72, 101, 108, 108, 111, 32, 82, 111, 99, 107, 101, 116, 77, 81, 48], transactionId='null'}]]\n\nConsumeMessageThread_3Receive New Messages :[MessageExt [queueId=2, storeSize=177, queueOffset=9, sysFlag=0, bornTimestamp=1547086138573, bornHost=/192.168.237.1:53524, storeTimestamp=1547139430783, storeHost=/192.168.237.128:10911, msgId=C0A8ED8000002A9F000000000000234D, commitLogOffset=9037, bodyCRC=1561245975, reconsumeTimes=0, preparedTransactionOffset=0, toString()=Message{topic='TopicTest', flag=0, properties={MIN_OFFSET=0, MAX_OFFSET=10, CONSUME_START_TIME=1547086138598, UNIQ_KEY=0A0D53073B6073D16E933086C4CD0001, WAIT=true, TAGS=TagA}, body=[72, 101, 108, 108, 111, 32, 82, 111, 99, 107, 101, 116, 77, 81, 49], transactionId='null'}]]\n\nConsumeMessageThread_17Receive New Messages :[MessageExt [queueId=3, storeSize=177, queueOffset=9, sysFlag=0, bornTimestamp=1547086138585, bornHost=/192.168.237.1:53524, storeTimestamp=1547139430794, storeHost=/192.168.237.128:10911, msgId=C0A8ED8000002A9F00000000000023FE, commitLogOffset=9214, bodyCRC=1141369005, reconsumeTimes=0, preparedTransactionOffset=0, toString()=Message{topic='TopicTest', flag=0, properties={MIN_OFFSET=0, MAX_OFFSET=10, CONSUME_START_TIME=1547086138601, UNIQ_KEY=0A0D53073B6073D16E933086C4D90002, WAIT=true, TAGS=TagA}, body=[72, 101, 108, 108, 111, 32, 82, 111, 99, 107, 101, 116, 77, 81, 50], transactionId='null'}]]\n\nConsumeMessageThread_9Receive New Messages :[MessageExt [queueId=0, storeSize=177, queueOffset=11, sysFlag=0, bornTimestamp=1547086138600, bornHost=/192.168.237.1:53524, storeTimestamp=1547139430807, storeHost=/192.168.237.128:10911, msgId=C0A8ED8000002A9F00000000000024AF, commitLogOffset=9391, bodyCRC=855693371, reconsumeTimes=0, preparedTransactionOffset=0, toString()=Message{topic='TopicTest', flag=0, properties={MIN_OFFSET=0, MAX_OFFSET=12, CONSUME_START_TIME=1547086138612, UNIQ_KEY=0A0D53073B6073D16E933086C4E80003, WAIT=true, TAGS=TagA}, body=[72, 101, 108, 108, 111, 32, 82, 111, 99, 107, 101, 116, 77, 81, 51], transactionId='null'}]]\n\nConsumeMessageThread_15Receive New Messages :[MessageExt [queueId=1, storeSize=177, queueOffset=12, sysFlag=0, bornTimestamp=1547086138612, bornHost=/192.168.237.1:53524, storeTimestamp=1547139430809, storeHost=/192.168.237.128:10911, msgId=C0A8ED8000002A9F0000000000002560, commitLogOffset=9568, bodyCRC=761548184, reconsumeTimes=0, preparedTransactionOffset=0, toString()=Message{topic='TopicTest', flag=0, properties={MIN_OFFSET=0, MAX_OFFSET=13, CONSUME_START_TIME=1547086138626, UNIQ_KEY=0A0D53073B6073D16E933086C4F40004, WAIT=true, TAGS=TagA}, body=[72, 101, 108, 108, 111, 32, 82, 111, 99, 107, 101, 116, 77, 81, 52], transactionId='null'}]]\n\nConsumeMessageThread_11Receive New Messages :[MessageExt [queueId=2, storeSize=177, queueOffset=10, sysFlag=0, bornTimestamp=1547086138615, bornHost=/192.168.237.1:53524, storeTimestamp=1547139430820, storeHost=/192.168.237.128:10911, msgId=C0A8ED8000002A9F0000000000002611, commitLogOffset=9745, bodyCRC=1516469518, reconsumeTimes=0, preparedTransactionOffset=0, toString()=Message{topic='TopicTest', flag=0, properties={MIN_OFFSET=0, MAX_OFFSET=11, CONSUME_START_TIME=1547086138628, UNIQ_KEY=0A0D53073B6073D16E933086C4F70005, WAIT=true, TAGS=TagA}, body=[72, 101, 108, 108, 111, 32, 82, 111, 99, 107, 101, 116, 77, 81, 53], transactionId='null'}]]\n\nConsumeMessageThread_4Receive New Messages :[MessageExt [queueId=3, storeSize=177,queueOffset=10, sysFlag=0, bornTimestamp=1547086138627, bornHost=/192.168.237.1:53524, storeTimestamp=1547139430824, storeHost=/192.168.237.128:10911, msgId=C0A8ED8000002A9F00000000000026C2,commitLogOffset=9922, bodyCRC=1131031732,reconsumeTimes=0, preparedTransactionOffset=0, toString()=Message{topic='TopicTest', flag=0, properties={MIN_OFFSET=0, MAX_OFFSET=11, CONSUME_START_TIME=1547086138633, UNIQ_KEY=0A0D53073B6073D16E933086C5030006, WAIT=true, TAGS=TagA}, body=[72, 101, 108, 108, 111, 32, 82, 111, 99, 107, 101, 116, 77, 81, 54], transactionId='null'}]]\n\nConsumeMessageThread_14Receive New Messages :[MessageExt [queueId=0, storeSize=177, queueOffset=12, sysFlag=0, bornTimestamp=1547086138631, bornHost=/192.168.237.1:53524, storeTimestamp=1547139430827, storeHost=/192.168.237.128:10911, msgId=C0A8ED8000002A9F0000000000002773, commitLogOffset=10099, bodyCRC=879565858, reconsumeTimes=0, preparedTransactionOffset=0, toString()=Message{topic='TopicTest', flag=0, properties={MIN_OFFSET=0, MAX_OFFSET=13, CONSUME_START_TIME=1547086138635, UNIQ_KEY=0A0D53073B6073D16E933086C5070007, WAIT=true, TAGS=TagA}, body=[72, 101, 108, 108, 111, 32, 82, 111, 99, 107, 101, 116, 77, 81, 55], transactionId='null'}]]\n\nConsumeMessageThread_10Receive New Messages :[MessageExt [queueId=1, storeSize=177, queueOffset=13, sysFlag=0, bornTimestamp=1547086138634, bornHost=/192.168.237.1:53524, storeTimestamp=1547139430830, storeHost=/192.168.237.128:10911, msgId=C0A8ED8000002A9F0000000000002824, commitLogOffset=10276, bodyCRC=617742771, reconsumeTimes=0, preparedTransactionOffset=0, toString()=Message{topic='TopicTest', flag=0, properties={MIN_OFFSET=0, MAX_OFFSET=14, CONSUME_START_TIME=1547086138638, UNIQ_KEY=0A0D53073B6073D16E933086C50A0008, WAIT=true, TAGS=TagA}, body=[72, 101, 108, 108, 111, 32, 82, 111, 99, 107, 101, 116, 77, 81, 56], transactionId='null'}]]\n\nConsumeMessageThread_7Receive New Messages :[MessageExt [queueId=2, storeSize=177, queueOffset=11, sysFlag=0, bornTimestamp=1547086138637, bornHost=/192.168.237.1:53524, storeTimestamp=1547139430833, storeHost=/192.168.237.128:10911, msgId=C0A8ED8000002A9F00000000000028D5, commitLogOffset=10453, bodyCRC=1406480677, reconsumeTimes=0, preparedTransactionOffset=0, toString()=Message{topic='TopicTest', flag=0, properties={MIN_OFFSET=0, MAX_OFFSET=12, CONSUME_START_TIME=1547086138641, UNIQ_KEY=0A0D53073B6073D16E933086C50D0009, WAIT=true, TAGS=TagA}, body=[72, 101, 108, 108, 111, 32, 82, 111, 99, 107, 101, 116, 77, 81, 57], transactionId='null'}]]\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br"),a("span",{staticClass:"line-number"},[e._v("16")]),a("br"),a("span",{staticClass:"line-number"},[e._v("17")]),a("br"),a("span",{staticClass:"line-number"},[e._v("18")]),a("br"),a("span",{staticClass:"line-number"},[e._v("19")]),a("br")])]),a("h2",{attrs:{id:"多机集群配置和部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多机集群配置和部署"}},[e._v("#")]),e._v(" 多机集群配置和部署")]),e._v(" "),a("p",[e._v("分别部署两台NameServer，两台Broker并且分别提供Slave，准备两台电脑分别是本机的windows以及虚拟机centos；")]),e._v(" "),a("h3",{attrs:{id:"_1-启动nameserver"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-启动nameserver"}},[e._v("#")]),e._v(" 1.启动NameServer")]),e._v(" "),a("p",[e._v("分别启动2台NameServer，端口号都使用默认的9876，地址端口如下：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("192.168.237.128:9876\n10.13.83.7:9876\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("h3",{attrs:{id:"_2-启动broker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-启动broker"}},[e._v("#")]),e._v(" 2.启动Broker")]),e._v(" "),a("p",[e._v("每台机器上分别启动一个Master和一个Slave，互为主备，在主目录下的conf文件夹下提供了多种broker配置模式，分别有：2m-2s-async，2m-2s-sync，2m-noslave，可以以此为模版做如下配置：")]),e._v(" "),a("h4",{attrs:{id:"_2-1配置10-13-83-7master和slave"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1配置10-13-83-7master和slave"}},[e._v("#")]),e._v(" 2.1配置10.13.83.7Master和Slave")]),e._v(" "),a("p",[e._v("Master配置如下：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("namesrvAddr=192.168.237.128:9876;10.13.83.7:9876\nbrokerClusterName=DefaultCluster\nbrokerName=broker-a\nbrokerId=0\ndeleteWhen=04\nfileReservedTime=48\nbrokerRole=SYNC_MASTER\nflushDiskType=ASYNC_FLUSH\nlistenPort=10911\nstorePathRootDir=E:/rocketmq-all-4.3.2-bin-release/store-a-m\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br")])]),a("p",[e._v("Slave配置如下：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("namesrvAddr=192.168.237.128:9876;10.13.83.7:9876\nbrokerClusterName=DefaultCluster\nbrokerName=broker-a\nbrokerId=1\ndeleteWhen=04\nfileReservedTime=48\nbrokerRole=SLAVE\nflushDiskType=ASYNC_FLUSH\nlistenPort=10811\nstorePathRootDir=E:/rocketmq-all-4.3.2-bin-release/store-a-s\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br")])]),a("p",[e._v("分别启动结果如下：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("E:\\rocketmq-all-4.3.2-bin-release\\bin>mqbroker -c E:\\rocketmq-all-4.3.2-bin-rele\nase\\conf\\broker-m.conf\nThe broker[broker-a, 10.13.83.7:10911] boot success. serializeType=JSON and name\n server is 192.168.237.128:9876;10.13.83.7:9876\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])]),a("p",[e._v("以上是Master启动日志，Slave日志如下：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("E:\\rocketmq-all-4.3.2-bin-release\\bin>mqbroker -c E:\\rocketmq-all-4.3.2-bin-rele\nase\\conf\\broker-s.conf\nThe broker[broker-a, 10.13.83.7:10811] boot success. serializeType=JSON and name\n server is 192.168.237.128:9876;10.13.83.7:9876\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])]),a("h4",{attrs:{id:"_2-2配置10-13-83-7slave"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2配置10-13-83-7slave"}},[e._v("#")]),e._v(" 2.2配置10.13.83.7Slave")]),e._v(" "),a("p",[e._v("Master配置如下：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("namesrvAddr=192.168.237.128:9876;10.13.83.7:9876\nbrokerClusterName=DefaultCluster\nbrokerName=broker-b\nbrokerId=0\ndeleteWhen=04\nfileReservedTime=48\nbrokerRole=SYNC_MASTER\nflushDiskType=ASYNC_FLUSH\nlistenPort=10911\nstorePathRootDir=/root/rocketmq-all-4.3.2-bin-release/store-b-m\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br")])]),a("p",[e._v("Slave配置如下：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("namesrvAddr=192.168.237.128:9876;10.13.83.7:9876\nbrokerClusterName=DefaultCluster\nbrokerName=broker-b\nbrokerId=1\ndeleteWhen=04\nfileReservedTime=48\nbrokerRole=SLAVE\nflushDiskType=ASYNC_FLUSH\nlistenPort=10811\nstorePathRootDir=/root/rocketmq-all-4.3.2-bin-release/store-b-s\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br")])]),a("p",[e._v("启动日志分别如下：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("[root@localhost bin]# ./mqbroker -c ../conf/broker-m.conf \nThe broker[broker-b, 192.168.237.128:10911] boot success. serializeType=JSON and name server is 192.168.237.128:9876;10.13.83.7:9876\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("[root@localhost bin]# ./mqbroker -c ../conf/broker-s.conf \nThe broker[broker-b, 192.168.237.128:10811] boot success. serializeType=JSON and name server is 192.168.237.128:9876;10.13.83.7:9876\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("h3",{attrs:{id:"_3-配置说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-配置说明"}},[e._v("#")]),e._v(" 3.配置说明")]),e._v(" "),a("h4",{attrs:{id:"_1-namesrvaddr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-namesrvaddr"}},[e._v("#")]),e._v(" 1.namesrvAddr")]),e._v(" "),a("p",[e._v("NameServer地址，可以配置多个，用逗号分隔；")]),e._v(" "),a("h4",{attrs:{id:"_2-brokerclustername"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-brokerclustername"}},[e._v("#")]),e._v(" 2.brokerClusterName")]),e._v(" "),a("p",[e._v("所属集群名称，如果节点较多可以配置多个")]),e._v(" "),a("h4",{attrs:{id:"_3-brokername"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-brokername"}},[e._v("#")]),e._v(" 3.brokerName")]),e._v(" "),a("p",[e._v("broker名称，master和slave使用相同的名称，表明他们的主从关系")]),e._v(" "),a("h4",{attrs:{id:"_4-brokerid"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-brokerid"}},[e._v("#")]),e._v(" 4.brokerId")]),e._v(" "),a("p",[e._v("0表示Master，大于0表示不同的slave")]),e._v(" "),a("h4",{attrs:{id:"_5-deletewhen"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-deletewhen"}},[e._v("#")]),e._v(" 5.deleteWhen")]),e._v(" "),a("p",[e._v("表示几点做消息删除动作，默认是凌晨4点")]),e._v(" "),a("h4",{attrs:{id:"_6-filereservedtime"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-filereservedtime"}},[e._v("#")]),e._v(" 6.fileReservedTime")]),e._v(" "),a("p",[e._v("在磁盘上保留消息的时长，单位是小时")]),e._v(" "),a("h4",{attrs:{id:"_7-brokerrole"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-brokerrole"}},[e._v("#")]),e._v(" 7.brokerRole")]),e._v(" "),a("p",[e._v("有三个值：SYNC_MASTER，ASYNC_MASTER，SLAVE；同步和异步表示Master和Slave之间同步数据的机制；")]),e._v(" "),a("h4",{attrs:{id:"_8-flushdisktype"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-flushdisktype"}},[e._v("#")]),e._v(" 8.flushDiskType")]),e._v(" "),a("p",[e._v("刷盘策略，取值为：ASYNC_FLUSH，SYNC_FLUSH表示同步刷盘和异步刷盘；SYNC_FLUSH消息写入磁盘后才返回成功状态，ASYNC_FLUSH不需要；")]),e._v(" "),a("h4",{attrs:{id:"_9-listenport"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-listenport"}},[e._v("#")]),e._v(" 9.listenPort")]),e._v(" "),a("p",[e._v("启动监听的端口号")]),e._v(" "),a("h4",{attrs:{id:"_10-storepathrootdir"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-storepathrootdir"}},[e._v("#")]),e._v(" 10.storePathRootDir")]),e._v(" "),a("p",[e._v("存储消息的根目录")]),e._v(" "),a("h2",{attrs:{id:"管理工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#管理工具"}},[e._v("#")]),e._v(" 管理工具")]),e._v(" "),a("h3",{attrs:{id:"_1-命令行管理工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-命令行管理工具"}},[e._v("#")]),e._v(" 1.命令行管理工具")]),e._v(" "),a("p",[e._v("mqadmin是RocketMQ自带的命令行管理工具，可以创建、修改Topic，查询消息，更新配置信息等操作，具体可以通过如下命令查看：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("E:\\rocketmq-all-4.3.2-bin-release\\bin>mqadmin\nThe most commonly used mqadmin commands are:\n   updateTopic          Update or create topic\n   deleteTopic          Delete topic from broker and NameServer.\n   updateSubGroup       Update or create subscription group\n   deleteSubGroup       Delete subscription group from broker.\n   updateBrokerConfig   Update broker's config\n   updateTopicPerm      Update topic perm\n   topicRoute           Examine topic route info\n   topicStatus          Examine topic Status info\n   topicClusterList     get cluster info for topic\n   brokerStatus         Fetch broker runtime status data\n   queryMsgById         Query Message by Id\n   queryMsgByKey        Query Message by Key\n   queryMsgByUniqueKey  Query Message by Unique key\n   queryMsgByOffset     Query Message by offset\n   printMsg             Print Message Detail\n   printMsgByQueue      Print Message Detail\n   sendMsgStatus        send msg to broker.\n   brokerConsumeStats   Fetch broker consume stats data\n   producerConnection   Query producer's socket connection and client vers\n   consumerConnection   Query consumer's socket connection, client version\nubscription\n   consumerProgress     Query consumers's progress, speed\n   consumerStatus       Query consumer's internal data structure\n   cloneGroupOffset     clone offset from other group.\n   clusterList          List all of clusters\n   topicList            Fetch all topic list from name server\n   updateKvConfig       Create or update KV config.\n   deleteKvConfig       Delete KV config.\n   wipeWritePerm        Wipe write perm of broker in all name server\n   resetOffsetByTime    Reset consumer offset by timestamp(without client\nt).\n   updateOrderConf      Create or update or delete order conf\n   cleanExpiredCQ       Clean expired ConsumeQueue on broker.\n   cleanUnusedTopic     Clean unused topic on broker.\n   startMonitoring      Start Monitoring\n   statsAll             Topic and Consumer tps stats\n   allocateMQ           Allocate MQ\n   checkMsgSendRT       check message send response time\n   clusterRT            List All clusters Message Send RT\n   getNamesrvConfig     Get configs of name server.\n   updateNamesrvConfig  Update configs of name server.\n   getBrokerConfig      Get broker config by cluster or special broker!\n   queryCq              Query cq command.\n   sendMessage          Send a message\n   consumeMessage       Consume message\n\nSee 'mqadmin help <command>' for more information on a specific command.\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br"),a("span",{staticClass:"line-number"},[e._v("16")]),a("br"),a("span",{staticClass:"line-number"},[e._v("17")]),a("br"),a("span",{staticClass:"line-number"},[e._v("18")]),a("br"),a("span",{staticClass:"line-number"},[e._v("19")]),a("br"),a("span",{staticClass:"line-number"},[e._v("20")]),a("br"),a("span",{staticClass:"line-number"},[e._v("21")]),a("br"),a("span",{staticClass:"line-number"},[e._v("22")]),a("br"),a("span",{staticClass:"line-number"},[e._v("23")]),a("br"),a("span",{staticClass:"line-number"},[e._v("24")]),a("br"),a("span",{staticClass:"line-number"},[e._v("25")]),a("br"),a("span",{staticClass:"line-number"},[e._v("26")]),a("br"),a("span",{staticClass:"line-number"},[e._v("27")]),a("br"),a("span",{staticClass:"line-number"},[e._v("28")]),a("br"),a("span",{staticClass:"line-number"},[e._v("29")]),a("br"),a("span",{staticClass:"line-number"},[e._v("30")]),a("br"),a("span",{staticClass:"line-number"},[e._v("31")]),a("br"),a("span",{staticClass:"line-number"},[e._v("32")]),a("br"),a("span",{staticClass:"line-number"},[e._v("33")]),a("br"),a("span",{staticClass:"line-number"},[e._v("34")]),a("br"),a("span",{staticClass:"line-number"},[e._v("35")]),a("br"),a("span",{staticClass:"line-number"},[e._v("36")]),a("br"),a("span",{staticClass:"line-number"},[e._v("37")]),a("br"),a("span",{staticClass:"line-number"},[e._v("38")]),a("br"),a("span",{staticClass:"line-number"},[e._v("39")]),a("br"),a("span",{staticClass:"line-number"},[e._v("40")]),a("br"),a("span",{staticClass:"line-number"},[e._v("41")]),a("br"),a("span",{staticClass:"line-number"},[e._v("42")]),a("br"),a("span",{staticClass:"line-number"},[e._v("43")]),a("br"),a("span",{staticClass:"line-number"},[e._v("44")]),a("br"),a("span",{staticClass:"line-number"},[e._v("45")]),a("br"),a("span",{staticClass:"line-number"},[e._v("46")]),a("br"),a("span",{staticClass:"line-number"},[e._v("47")]),a("br"),a("span",{staticClass:"line-number"},[e._v("48")]),a("br"),a("span",{staticClass:"line-number"},[e._v("49")]),a("br")])]),a("p",[e._v("列出了所有支持的命令以及简单的介绍，如果想看详细的可以如下命令：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("E:\\rocketmq-all-4.3.2-bin-release\\bin>mqadmin help statsAll\nusage: mqadmin statsAll [-a] [-h] [-n <arg>] [-t <arg>]\n -a,--activeTopic         print active topic only\n -h,--help                Print help\n -n,--namesrvAddr <arg>   Name server address list, eg: 192.168.0.1:9876;192.168\n.0.2:9876\n -t,--topic <arg>         print select topic only\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br")])]),a("h3",{attrs:{id:"_2-图形界面管理工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-图形界面管理工具"}},[e._v("#")]),e._v(" 2.图形界面管理工具")]),e._v(" "),a("p",[e._v("除了命令，还提供了图形界面管理工具，在RocketMQ的扩展包里面，具体地址如下：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("https://github.com/apache/rocketmq-externals/tree/release-rocketmq-console-1.0.0/rocketmq-console\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("目前的稳定版本是1.0.0，可以下载下来在本地运行，对application.properties做简单配置：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("rocketmq.config.namesrvAddr=10.13.83.7:9876\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("需要指定NameServer的地址，然后就可以打包运行了，运作之后会启动8080端口，直接访问地址：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("http://localhost:8080\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://oscimg.oschina.net/oscnet/4e6af5773de8faa6f4216a80e3d5c9f0811.jpg",alt:""}})]),e._v(" "),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[e._v("#")]),e._v(" 总结")]),e._v(" "),a("p",[e._v("本文从最简单的安装部署入手，并对常用的配置参数做了简单介绍；然后了解了RocketMQ的部署的整体结构，分别对其中的角色做了简单介绍；最后介绍了两种RocketMQ的管理工具，方便对RocketMQ的监控和管理。")])])}),[],!1,null,null,null);s.default=t.exports}}]);